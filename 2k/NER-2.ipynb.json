{"cells":[{"cell_type":"markdown","metadata":{"id":"L2Lg7easbotD"},"source":["###  Извлечение именованных сущностей (NER) и отношений"]},{"cell_type":"markdown","metadata":{"id":"exrhAEEAbotG"},"source":["b-person\n","i-person\n","i-person\n","i-person\n","o-person"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"lzuze_0DbotG"},"outputs":[],"source":["является датой, Кофи Аннан Аннан – персоной\n","O         O     B     I       I       o"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xEVSwNifbotI"},"outputs":[],"source":["person\n","no_person"]},{"cell_type":"markdown","metadata":{"id":"ghd1X3FGbotI"},"source":["Одна из самых популярных задач NLP – извлечении именованных сущностей (Named-entity recognition, NER). Задача NER – выделить спаны сущностей в тексте (спан – непрерывный фрагмент текста). Допустим, есть новостной текст, и мы хотим выделить в нем сущности (некоторый заранее зафиксированный набор — например, персоны, локации, организации, даты и так далее). Задача NER – понять, что участок текста “1 января 1997 года” является датой, “Кофи Аннан” – персоной, а “ООН” – организацией.\n","\n","##### Зачем?\n","1.  Cтруктуризация неструктурированных данных. Пусть у вас есть какой-то текст (или набор текстов), и данные из него нужно ввести в базу данных (таблицу).\n","2. Шаг в сторону “понимания” текста. Это может как иметь самостоятельную ценность, так и помочь лучше решать другие задачи NLP. Без решения задачи NER тяжело представить себе решение многих задач NLP, допустим, разрешение местоименной анафоры или построение вопросно-ответных систем.\n","\n","Пример 1: Местоименная анафора позволяет нам понять, к какому элементу текста относится местоимение. Например, пусть мы хотим проанализировать текст “Прискакал Чарминг на белом коне. Принцесса выбежала ему навстречу и поцеловала его”. Если мы выделили на слове “Чарминг” сущность Персона, то машина сможет намного легче понять, что принцесса, скорее всего, поцеловала не коня, а принца Чарминга.\n","\n","Пример 2: Теперь приведем пример, как выделение именованных сущностей может помочь при построении вопросно-ответных систем. Если задать в вашем любимом поисковике вопрос «Кто играл роль Дарта Вейдера в фильме “Империя наносит ответный удар”», то с большой вероятностью вы получите верный ответ. Это делается как раз с помощью выделения именованных сущностей: выделяем сущности (фильм, роль и т. п.), понимаем, что нас спрашивают, и дальше ищем ответ в базе данных.\n","\n","Для решения NER-задач существуют множество инструментов. Рассмотрим несколько из них.\n"]},{"cell_type":"markdown","metadata":{"id":"-k4wZujmbotJ"},"source":["#### NLTK"]},{"cell_type":"markdown","metadata":{"id":"4Mc32S7ebotK"},"source":["<img src='image/nltk.PNG'>"]},{"cell_type":"markdown","metadata":{"id":"jAsPhWxAbotK"},"source":["Для разметки NER с помощью NLTK сначала производим токенизацию слов, затем POS тэггинг.\n","В качестве документа возьмем статью 'https://www.nytimes.com/2018/08/13/us/politics/peter-strzok-fired-fbi.html?hp&action=click&pgtype=Homepage&clickSource=story-heading&module=first-column-region&region=top-news&WT.nav=top-news, распарсим ее с помощью BeautifulSoup."]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"N3vn8ijHbotL","executionInfo":{"status":"ok","timestamp":1728396174300,"user_tz":-300,"elapsed":55215,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"655f9c64-1805-4cac-fb02-a63ac64ce5ea"},"outputs":[{"output_type":"stream","name":"stderr","text":["[nltk_data] Downloading collection 'all'\n","[nltk_data]    | \n","[nltk_data]    | Downloading package abc to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/abc.zip.\n","[nltk_data]    | Downloading package alpino to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/alpino.zip.\n","[nltk_data]    | Downloading package averaged_perceptron_tagger to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping taggers/averaged_perceptron_tagger.zip.\n","[nltk_data]    | Downloading package averaged_perceptron_tagger_eng to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping\n","[nltk_data]    |       taggers/averaged_perceptron_tagger_eng.zip.\n","[nltk_data]    | Downloading package averaged_perceptron_tagger_ru to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping\n","[nltk_data]    |       taggers/averaged_perceptron_tagger_ru.zip.\n","[nltk_data]    | Downloading package averaged_perceptron_tagger_rus to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping\n","[nltk_data]    |       taggers/averaged_perceptron_tagger_rus.zip.\n","[nltk_data]    | Downloading package basque_grammars to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping grammars/basque_grammars.zip.\n","[nltk_data]    | Downloading package bcp47 to /root/nltk_data...\n","[nltk_data]    | Downloading package biocreative_ppi to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/biocreative_ppi.zip.\n","[nltk_data]    | Downloading package bllip_wsj_no_aux to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping models/bllip_wsj_no_aux.zip.\n","[nltk_data]    | Downloading package book_grammars to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping grammars/book_grammars.zip.\n","[nltk_data]    | Downloading package brown to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/brown.zip.\n","[nltk_data]    | Downloading package brown_tei to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/brown_tei.zip.\n","[nltk_data]    | Downloading package cess_cat to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/cess_cat.zip.\n","[nltk_data]    | Downloading package cess_esp to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/cess_esp.zip.\n","[nltk_data]    | Downloading package chat80 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/chat80.zip.\n","[nltk_data]    | Downloading package city_database to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/city_database.zip.\n","[nltk_data]    | Downloading package cmudict to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/cmudict.zip.\n","[nltk_data]    | Downloading package comparative_sentences to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/comparative_sentences.zip.\n","[nltk_data]    | Downloading package comtrans to /root/nltk_data...\n","[nltk_data]    | Downloading package conll2000 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/conll2000.zip.\n","[nltk_data]    | Downloading package conll2002 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/conll2002.zip.\n","[nltk_data]    | Downloading package conll2007 to /root/nltk_data...\n","[nltk_data]    | Downloading package crubadan to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/crubadan.zip.\n","[nltk_data]    | Downloading package dependency_treebank to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/dependency_treebank.zip.\n","[nltk_data]    | Downloading package dolch to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/dolch.zip.\n","[nltk_data]    | Downloading package europarl_raw to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/europarl_raw.zip.\n","[nltk_data]    | Downloading package extended_omw to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    | Downloading package floresta to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/floresta.zip.\n","[nltk_data]    | Downloading package framenet_v15 to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/framenet_v15.zip.\n","[nltk_data]    | Downloading package framenet_v17 to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/framenet_v17.zip.\n","[nltk_data]    | Downloading package gazetteers to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/gazetteers.zip.\n","[nltk_data]    | Downloading package genesis to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/genesis.zip.\n","[nltk_data]    | Downloading package gutenberg to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/gutenberg.zip.\n","[nltk_data]    | Downloading package ieer to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/ieer.zip.\n","[nltk_data]    | Downloading package inaugural to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/inaugural.zip.\n","[nltk_data]    | Downloading package indian to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/indian.zip.\n","[nltk_data]    | Downloading package jeita to /root/nltk_data...\n","[nltk_data]    | Downloading package kimmo to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/kimmo.zip.\n","[nltk_data]    | Downloading package knbc to /root/nltk_data...\n","[nltk_data]    | Downloading package large_grammars to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping grammars/large_grammars.zip.\n","[nltk_data]    | Downloading package lin_thesaurus to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/lin_thesaurus.zip.\n","[nltk_data]    | Downloading package mac_morpho to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/mac_morpho.zip.\n","[nltk_data]    | Downloading package machado to /root/nltk_data...\n","[nltk_data]    | Downloading package masc_tagged to /root/nltk_data...\n","[nltk_data]    | Downloading package maxent_ne_chunker to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping chunkers/maxent_ne_chunker.zip.\n","[nltk_data]    | Downloading package maxent_ne_chunker_tab to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping chunkers/maxent_ne_chunker_tab.zip.\n","[nltk_data]    | Downloading package maxent_treebank_pos_tagger to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping taggers/maxent_treebank_pos_tagger.zip.\n","[nltk_data]    | Downloading package maxent_treebank_pos_tagger_tab to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping\n","[nltk_data]    |       taggers/maxent_treebank_pos_tagger_tab.zip.\n","[nltk_data]    | Downloading package moses_sample to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping models/moses_sample.zip.\n","[nltk_data]    | Downloading package movie_reviews to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/movie_reviews.zip.\n","[nltk_data]    | Downloading package mte_teip5 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/mte_teip5.zip.\n","[nltk_data]    | Downloading package mwa_ppdb to /root/nltk_data...\n","[nltk_data]    |   Unzipping misc/mwa_ppdb.zip.\n","[nltk_data]    | Downloading package names to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/names.zip.\n","[nltk_data]    | Downloading package nombank.1.0 to /root/nltk_data...\n","[nltk_data]    | Downloading package nonbreaking_prefixes to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/nonbreaking_prefixes.zip.\n","[nltk_data]    | Downloading package nps_chat to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/nps_chat.zip.\n","[nltk_data]    | Downloading package omw to /root/nltk_data...\n","[nltk_data]    | Downloading package omw-1.4 to /root/nltk_data...\n","[nltk_data]    | Downloading package opinion_lexicon to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/opinion_lexicon.zip.\n","[nltk_data]    | Downloading package panlex_swadesh to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    | Downloading package paradigms to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/paradigms.zip.\n","[nltk_data]    | Downloading package pe08 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/pe08.zip.\n","[nltk_data]    | Downloading package perluniprops to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping misc/perluniprops.zip.\n","[nltk_data]    | Downloading package pil to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/pil.zip.\n","[nltk_data]    | Downloading package pl196x to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/pl196x.zip.\n","[nltk_data]    | Downloading package porter_test to /root/nltk_data...\n","[nltk_data]    |   Unzipping stemmers/porter_test.zip.\n","[nltk_data]    | Downloading package ppattach to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/ppattach.zip.\n","[nltk_data]    | Downloading package problem_reports to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/problem_reports.zip.\n","[nltk_data]    | Downloading package product_reviews_1 to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/product_reviews_1.zip.\n","[nltk_data]    | Downloading package product_reviews_2 to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/product_reviews_2.zip.\n","[nltk_data]    | Downloading package propbank to /root/nltk_data...\n","[nltk_data]    | Downloading package pros_cons to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/pros_cons.zip.\n","[nltk_data]    | Downloading package ptb to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/ptb.zip.\n","[nltk_data]    | Downloading package punkt to /root/nltk_data...\n","[nltk_data]    |   Unzipping tokenizers/punkt.zip.\n","[nltk_data]    | Downloading package punkt_tab to /root/nltk_data...\n","[nltk_data]    |   Unzipping tokenizers/punkt_tab.zip.\n","[nltk_data]    | Downloading package qc to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/qc.zip.\n","[nltk_data]    | Downloading package reuters to /root/nltk_data...\n","[nltk_data]    | Downloading package rslp to /root/nltk_data...\n","[nltk_data]    |   Unzipping stemmers/rslp.zip.\n","[nltk_data]    | Downloading package rte to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/rte.zip.\n","[nltk_data]    | Downloading package sample_grammars to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping grammars/sample_grammars.zip.\n","[nltk_data]    | Downloading package semcor to /root/nltk_data...\n","[nltk_data]    | Downloading package senseval to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/senseval.zip.\n","[nltk_data]    | Downloading package sentence_polarity to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/sentence_polarity.zip.\n","[nltk_data]    | Downloading package sentiwordnet to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/sentiwordnet.zip.\n","[nltk_data]    | Downloading package shakespeare to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/shakespeare.zip.\n","[nltk_data]    | Downloading package sinica_treebank to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/sinica_treebank.zip.\n","[nltk_data]    | Downloading package smultron to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/smultron.zip.\n","[nltk_data]    | Downloading package snowball_data to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    | Downloading package spanish_grammars to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping grammars/spanish_grammars.zip.\n","[nltk_data]    | Downloading package state_union to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/state_union.zip.\n","[nltk_data]    | Downloading package stopwords to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/stopwords.zip.\n","[nltk_data]    | Downloading package subjectivity to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/subjectivity.zip.\n","[nltk_data]    | Downloading package swadesh to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/swadesh.zip.\n","[nltk_data]    | Downloading package switchboard to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/switchboard.zip.\n","[nltk_data]    | Downloading package tagsets to /root/nltk_data...\n","[nltk_data]    |   Unzipping help/tagsets.zip.\n","[nltk_data]    | Downloading package tagsets_json to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping help/tagsets_json.zip.\n","[nltk_data]    | Downloading package timit to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/timit.zip.\n","[nltk_data]    | Downloading package toolbox to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/toolbox.zip.\n","[nltk_data]    | Downloading package treebank to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/treebank.zip.\n","[nltk_data]    | Downloading package twitter_samples to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/twitter_samples.zip.\n","[nltk_data]    | Downloading package udhr to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/udhr.zip.\n","[nltk_data]    | Downloading package udhr2 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/udhr2.zip.\n","[nltk_data]    | Downloading package unicode_samples to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/unicode_samples.zip.\n","[nltk_data]    | Downloading package universal_tagset to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping taggers/universal_tagset.zip.\n","[nltk_data]    | Downloading package universal_treebanks_v20 to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    | Downloading package vader_lexicon to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    | Downloading package verbnet to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/verbnet.zip.\n","[nltk_data]    | Downloading package verbnet3 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/verbnet3.zip.\n","[nltk_data]    | Downloading package webtext to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/webtext.zip.\n","[nltk_data]    | Downloading package wmt15_eval to /root/nltk_data...\n","[nltk_data]    |   Unzipping models/wmt15_eval.zip.\n","[nltk_data]    | Downloading package word2vec_sample to\n","[nltk_data]    |     /root/nltk_data...\n","[nltk_data]    |   Unzipping models/word2vec_sample.zip.\n","[nltk_data]    | Downloading package wordnet to /root/nltk_data...\n","[nltk_data]    | Downloading package wordnet2021 to /root/nltk_data...\n","[nltk_data]    | Downloading package wordnet2022 to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/wordnet2022.zip.\n","[nltk_data]    | Downloading package wordnet31 to /root/nltk_data...\n","[nltk_data]    | Downloading package wordnet_ic to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/wordnet_ic.zip.\n","[nltk_data]    | Downloading package words to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/words.zip.\n","[nltk_data]    | Downloading package ycoe to /root/nltk_data...\n","[nltk_data]    |   Unzipping corpora/ycoe.zip.\n","[nltk_data]    | \n","[nltk_data]  Done downloading collection all\n"]},{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":3}],"source":["import nltk\n","nltk.download('all')"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"C9YgI3abbotL","executionInfo":{"status":"ok","timestamp":1728396182935,"user_tz":-300,"elapsed":351,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"457fe51c-c3e1-483e-d649-e850b1872a87"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('nytimes.comPlease', 'NN'),\n"," ('enable', 'JJ'),\n"," ('JS', 'NNP'),\n"," ('and', 'CC'),\n"," ('disable', 'JJ'),\n"," ('any', 'DT'),\n"," ('ad', 'NN'),\n"," ('blocker', 'NN')]"]},"metadata":{},"execution_count":5}],"source":["import requests\n","from bs4 import BeautifulSoup\n","import re\n","\n","def url_to_string(url):\n","    res = requests.get(url)\n","    html = res.text\n","    soup = BeautifulSoup(html, 'html5lib')\n","    for script in soup([\"script\", \"style\", 'aside']):\n","        script.extract()\n","    return \" \".join(re.split(r'[\\n\\t]+', soup.get_text()))\n","\n","document = url_to_string('https://www.nytimes.com/2018/08/13/us/politics/peter-strzok-fired-fbi.html?hp&action=click&pgtype=Homepage&clickSource=story-heading&module=first-column-region&region=top-news&WT.nav=top-news')\n","\n","nltk.pos_tag(nltk.word_tokenize(document))"]},{"cell_type":"markdown","metadata":{"id":"TuPyjSQTbotM"},"source":["С помощью функции nltk.ne_chunk () мы можем распознавать именованные сущности с помощью классификатора, который добавляет метки категорий, такие как PERSON, ORGANIZATION и GPE."]},{"cell_type":"code","execution_count":6,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"ynBLqf82botN","executionInfo":{"status":"ok","timestamp":1728396183615,"user_tz":-300,"elapsed":352,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"d217801d-719f-41d3-f464-f596ff81d159"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["set()"]},"metadata":{},"execution_count":6}],"source":["{(' '.join(c[0] for c in chunk), chunk.label() ) for chunk in nltk.ne_chunk(nltk.pos_tag(nltk.word_tokenize(document))) if hasattr(chunk, 'label') }"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"HVNtAs1bbotN","executionInfo":{"status":"ok","timestamp":1728396183615,"user_tz":-300,"elapsed":8,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"ZyDudqUWbotO"},"source":["#### Spacy\n","\n","Spacy значительно быстрее NLTK, так как она написана на Cython и работает с объектами.\n","Для NER Spacy работает как простой классификатор (неглубокая нейронная сеть с одним скрытым слоем). Объект Doc хранит последовательности токенов и все их аннотации."]},{"cell_type":"markdown","metadata":{"id":"lEIzt3aGbotO"},"source":["<img src='image/spacy.PNG'>"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"FuEveYcMbotO","executionInfo":{"status":"ok","timestamp":1728396183616,"user_tz":-300,"elapsed":8,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["!pip -q install spacy\n","!python -m spacy download en\n","!python -m spacy download en_core_web_sm"]},{"cell_type":"code","source":["!pip install -U spacy\n","!python -m spacy info"],"metadata":{"id":"yZ2knQK0edJi"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":107},"id":"AubJKQdEbotO","executionInfo":{"status":"ok","timestamp":1728396782474,"user_tz":-300,"elapsed":2369,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"7b03e9b1-f6c6-4981-e877-7203a9493fc6"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/spacy/displacy/__init__.py:213: UserWarning: [W006] No entities to visualize found in Doc object. If this is surprising to you, make sure the Doc was processed using a model that supports named entity recognition, and check the `doc.ents` property manually if necessary.\n","  warnings.warn(Warnings.W006)\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">nytimes.comPlease enable JS and disable any ad blocker</div></span>"]},"metadata":{}}],"source":["import spacy\n","from spacy import displacy\n","import en_core_web_sm\n","\n","nlp = en_core_web_sm.load()\n","ny_bb = url_to_string('https://www.nytimes.com/2018/08/13/us/politics/peter-strzok-fired-fbi.html?hp&action=click&pgtype=Homepage&clickSource=story-heading&module=first-column-region&region=top-news&WT.nav=top-news')\n","article = nlp(ny_bb)\n","displacy.render(article, jupyter=True, style='ent')\n"]},{"cell_type":"markdown","metadata":{"id":"L9R3mY6EbotP"},"source":["#### Deeppavlov\n","\n","DeepPavlov-это библиотека ИИ с открытым исходным кодом, построенная на TensorFlow и Keras. DeepPavlov предназначена для разработки чат-ботов и сложных разговорных систем, исследований в области nlp и, в частности, диалоговых систем.\n","\n","DeepPavlov использует несколько более новый вариант глубокой нейронной архитектуры Flair, известный как гибридная модель Bi-LSTM-CRF.\n","\n","<img src='image/deeppavlov.PNG'>\n","\n","Используем предтренированную модель \"ner_ontonotes_bert_mult\", которая работает с разными языками, в том числе и русским. Подадим на распознование предложение на русском языке."]},{"cell_type":"code","source":["!pip install deeppavlov\n","!python -m deeppavlov install squad_bert"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"zPzgFgunehr5","executionInfo":{"status":"ok","timestamp":1728397039154,"user_tz":-300,"elapsed":238213,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"b1da5da5-3d60-4147-86e5-e9c00572096f"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting deeppavlov\n","  Downloading deeppavlov-1.7.0-py3-none-any.whl.metadata (9.5 kB)\n","Collecting fastapi<=0.89.1,>=0.47.0 (from deeppavlov)\n","  Downloading fastapi-0.89.1-py3-none-any.whl.metadata (24 kB)\n","Collecting filelock<3.10.0,>=3.0.0 (from deeppavlov)\n","  Downloading filelock-3.9.1-py3-none-any.whl.metadata (2.4 kB)\n","Requirement already satisfied: nltk<3.10.0,>=3.2.4 in /usr/local/lib/python3.10/dist-packages (from deeppavlov) (3.8.1)\n","Collecting numpy<1.24 (from deeppavlov)\n","  Downloading numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.3 kB)\n","Collecting pandas<1.6.0,>=1.0.0 (from deeppavlov)\n","  Downloading pandas-1.5.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)\n","Requirement already satisfied: prometheus-client<=1.16.0,>=0.13.0 in /usr/local/lib/python3.10/dist-packages (from deeppavlov) (0.21.0)\n","Collecting pydantic<2 (from deeppavlov)\n","  Downloading pydantic-1.10.18-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (152 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m152.2/152.2 kB\u001b[0m \u001b[31m5.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting pybind11==2.10.3 (from deeppavlov)\n","  Downloading pybind11-2.10.3-py3-none-any.whl.metadata (9.4 kB)\n","Requirement already satisfied: requests<3.0.0,>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from deeppavlov) (2.32.3)\n","Collecting tqdm<4.65.0,>=4.42.0 (from deeppavlov)\n","  Downloading tqdm-4.64.1-py2.py3-none-any.whl.metadata (57 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.3/57.3 kB\u001b[0m \u001b[31m3.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting uvicorn<0.19.0,>=0.13.0 (from deeppavlov)\n","  Downloading uvicorn-0.18.3-py3-none-any.whl.metadata (6.2 kB)\n","Requirement already satisfied: wheel in /usr/local/lib/python3.10/dist-packages (from deeppavlov) (0.44.0)\n","Collecting scikit-learn<1.1.0,>=0.24 (from deeppavlov)\n","  Downloading scikit_learn-1.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (10 kB)\n","Collecting scipy==1.10.0 (from deeppavlov)\n","  Downloading scipy-1.10.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (58 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.9/58.9 kB\u001b[0m \u001b[31m3.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting starlette==0.22.0 (from fastapi<=0.89.1,>=0.47.0->deeppavlov)\n","  Downloading starlette-0.22.0-py3-none-any.whl.metadata (5.8 kB)\n","Requirement already satisfied: anyio<5,>=3.4.0 in /usr/local/lib/python3.10/dist-packages (from starlette==0.22.0->fastapi<=0.89.1,>=0.47.0->deeppavlov) (3.7.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.10/dist-packages (from nltk<3.10.0,>=3.2.4->deeppavlov) (8.1.7)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.10/dist-packages (from nltk<3.10.0,>=3.2.4->deeppavlov) (1.4.2)\n","Requirement already satisfied: regex>=2021.8.3 in /usr/local/lib/python3.10/dist-packages (from nltk<3.10.0,>=3.2.4->deeppavlov) (2024.9.11)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas<1.6.0,>=1.0.0->deeppavlov) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas<1.6.0,>=1.0.0->deeppavlov) (2024.2)\n","Requirement already satisfied: typing-extensions>=4.2.0 in /usr/local/lib/python3.10/dist-packages (from pydantic<2->deeppavlov) (4.12.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests<3.0.0,>=2.19.0->deeppavlov) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3.0.0,>=2.19.0->deeppavlov) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3.0.0,>=2.19.0->deeppavlov) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3.0.0,>=2.19.0->deeppavlov) (2024.8.30)\n","Requirement already satisfied: threadpoolctl>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn<1.1.0,>=0.24->deeppavlov) (3.5.0)\n","Collecting h11>=0.8 (from uvicorn<0.19.0,>=0.13.0->deeppavlov)\n","  Downloading h11-0.14.0-py3-none-any.whl.metadata (8.2 kB)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas<1.6.0,>=1.0.0->deeppavlov) (1.16.0)\n","Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.4.0->starlette==0.22.0->fastapi<=0.89.1,>=0.47.0->deeppavlov) (1.3.1)\n","Requirement already satisfied: exceptiongroup in /usr/local/lib/python3.10/dist-packages (from anyio<5,>=3.4.0->starlette==0.22.0->fastapi<=0.89.1,>=0.47.0->deeppavlov) (1.2.2)\n","Downloading deeppavlov-1.7.0-py3-none-any.whl (492 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m492.7/492.7 kB\u001b[0m \u001b[31m15.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pybind11-2.10.3-py3-none-any.whl (222 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m222.4/222.4 kB\u001b[0m \u001b[31m14.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading scipy-1.10.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (34.4 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m34.4/34.4 MB\u001b[0m \u001b[31m31.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading fastapi-0.89.1-py3-none-any.whl (55 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m55.8/55.8 kB\u001b[0m \u001b[31m3.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading starlette-0.22.0-py3-none-any.whl (64 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m64.3/64.3 kB\u001b[0m \u001b[31m4.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading filelock-3.9.1-py3-none-any.whl (9.7 kB)\n","Downloading numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m17.1/17.1 MB\u001b[0m \u001b[31m58.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pandas-1.5.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m12.1/12.1 MB\u001b[0m \u001b[31m65.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pydantic-1.10.18-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m3.1/3.1 MB\u001b[0m \u001b[31m54.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading scikit_learn-1.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (26.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m26.5/26.5 MB\u001b[0m \u001b[31m13.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tqdm-4.64.1-py2.py3-none-any.whl (78 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.5/78.5 kB\u001b[0m \u001b[31m4.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading uvicorn-0.18.3-py3-none-any.whl (57 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m57.4/57.4 kB\u001b[0m \u001b[31m3.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading h11-0.14.0-py3-none-any.whl (58 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m58.3/58.3 kB\u001b[0m \u001b[31m3.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: tqdm, pydantic, pybind11, numpy, h11, filelock, uvicorn, starlette, scipy, pandas, scikit-learn, fastapi, deeppavlov\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.66.5\n","    Uninstalling tqdm-4.66.5:\n","      Successfully uninstalled tqdm-4.66.5\n","  Attempting uninstall: pydantic\n","    Found existing installation: pydantic 2.9.2\n","    Uninstalling pydantic-2.9.2:\n","      Successfully uninstalled pydantic-2.9.2\n","  Attempting uninstall: numpy\n","    Found existing installation: numpy 2.0.2\n","    Uninstalling numpy-2.0.2:\n","      Successfully uninstalled numpy-2.0.2\n","  Attempting uninstall: filelock\n","    Found existing installation: filelock 3.16.1\n","    Uninstalling filelock-3.16.1:\n","      Successfully uninstalled filelock-3.16.1\n","  Attempting uninstall: scipy\n","    Found existing installation: scipy 1.13.1\n","    Uninstalling scipy-1.13.1:\n","      Successfully uninstalled scipy-1.13.1\n","  Attempting uninstall: pandas\n","    Found existing installation: pandas 2.2.2\n","    Uninstalling pandas-2.2.2:\n","      Successfully uninstalled pandas-2.2.2\n","  Attempting uninstall: scikit-learn\n","    Found existing installation: scikit-learn 1.5.2\n","    Uninstalling scikit-learn-1.5.2:\n","      Successfully uninstalled scikit-learn-1.5.2\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","albucore 0.0.16 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\n","albumentations 1.4.15 requires numpy>=1.24.4, but you have numpy 1.23.5 which is incompatible.\n","albumentations 1.4.15 requires pydantic>=2.7.0, but you have pydantic 1.10.18 which is incompatible.\n","bigframes 1.21.0 requires numpy>=1.24.0, but you have numpy 1.23.5 which is incompatible.\n","bigframes 1.21.0 requires scikit-learn>=1.2.2, but you have scikit-learn 1.0.2 which is incompatible.\n","blis 1.0.1 requires numpy<3.0.0,>=2.0.0, but you have numpy 1.23.5 which is incompatible.\n","chex 0.1.87 requires numpy>=1.24.1, but you have numpy 1.23.5 which is incompatible.\n","cudf-cu12 24.6.1 requires pandas<2.2.3dev0,>=2.0, but you have pandas 1.5.3 which is incompatible.\n","google-colab 1.0.0 requires pandas==2.2.2, but you have pandas 1.5.3 which is incompatible.\n","jax 0.4.33 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\n","jaxlib 0.4.33 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\n","mizani 0.11.4 requires pandas>=2.1.0, but you have pandas 1.5.3 which is incompatible.\n","plotnine 0.13.6 requires pandas<3.0.0,>=2.1.0, but you have pandas 1.5.3 which is incompatible.\n","pytensor 2.25.5 requires filelock>=3.15, but you have filelock 3.9.1 which is incompatible.\n","thinc 8.3.2 requires numpy<2.1.0,>=2.0.0; python_version >= \"3.9\", but you have numpy 1.23.5 which is incompatible.\n","xarray 2024.9.0 requires numpy>=1.24, but you have numpy 1.23.5 which is incompatible.\n","xarray 2024.9.0 requires pandas>=2.1, but you have pandas 1.5.3 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed deeppavlov-1.7.0 fastapi-0.89.1 filelock-3.9.1 h11-0.14.0 numpy-1.23.5 pandas-1.5.3 pybind11-2.10.3 pydantic-1.10.18 scikit-learn-1.0.2 scipy-1.10.0 starlette-0.22.0 tqdm-4.64.1 uvicorn-0.18.3\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["numpy","pandas","pydantic","sklearn","tqdm"]},"id":"d1541feb2f0e4a9091b6ca63c8e941f5"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Collecting torch<1.14.0,>=1.6.0\n","  Downloading torch-1.13.1-cp310-cp310-manylinux1_x86_64.whl.metadata (24 kB)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch<1.14.0,>=1.6.0) (4.12.2)\n","Collecting nvidia-cuda-runtime-cu11==11.7.99 (from torch<1.14.0,>=1.6.0)\n","  Downloading nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cudnn-cu11==8.5.0.96 (from torch<1.14.0,>=1.6.0)\n","  Downloading nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cublas-cu11==11.10.3.66 (from torch<1.14.0,>=1.6.0)\n","  Downloading nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cuda-nvrtc-cu11==11.7.99 (from torch<1.14.0,>=1.6.0)\n","  Downloading nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Requirement already satisfied: setuptools in /usr/local/lib/python3.10/dist-packages (from nvidia-cublas-cu11==11.10.3.66->torch<1.14.0,>=1.6.0) (71.0.4)\n","Requirement already satisfied: wheel in /usr/local/lib/python3.10/dist-packages (from nvidia-cublas-cu11==11.10.3.66->torch<1.14.0,>=1.6.0) (0.44.0)\n","Downloading torch-1.13.1-cp310-cp310-manylinux1_x86_64.whl (887.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m887.5/887.5 MB\u001b[0m \u001b[31m2.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl (317.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m317.1/317.1 MB\u001b[0m \u001b[31m5.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl (21.0 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.0/21.0 MB\u001b[0m \u001b[31m63.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl (849 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m849.3/849.3 kB\u001b[0m \u001b[31m37.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl (557.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m557.1/557.1 MB\u001b[0m \u001b[31m936.4 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: nvidia-cuda-runtime-cu11, nvidia-cuda-nvrtc-cu11, nvidia-cublas-cu11, nvidia-cudnn-cu11, torch\n","  Attempting uninstall: torch\n","    Found existing installation: torch 2.4.1+cu121\n","    Uninstalling torch-2.4.1+cu121:\n","      Successfully uninstalled torch-2.4.1+cu121\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","torchaudio 2.4.1+cu121 requires torch==2.4.1, but you have torch 1.13.1 which is incompatible.\n","torchvision 0.19.1+cu121 requires torch==2.4.1, but you have torch 1.13.1 which is incompatible.\u001b[0m\u001b[31m\n","\u001b[0mSuccessfully installed nvidia-cublas-cu11-11.10.3.66 nvidia-cuda-nvrtc-cu11-11.7.99 nvidia-cuda-runtime-cu11-11.7.99 nvidia-cudnn-cu11-8.5.0.96 torch-1.13.1\n","Ignoring transformers: markers 'python_version < \"3.8\"' don't match your environment\n","Collecting transformers==4.30.0\n","  Downloading transformers-4.30.0-py3-none-any.whl.metadata (113 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m113.6/113.6 kB\u001b[0m \u001b[31m2.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (3.9.1)\n","Requirement already satisfied: huggingface-hub<1.0,>=0.14.1 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (0.24.7)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (1.23.5)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (24.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (6.0.2)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (2024.9.11)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (2.32.3)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers==4.30.0)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)\n","Requirement already satisfied: safetensors>=0.3.1 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (0.4.5)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers==4.30.0) (4.64.1)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers==4.30.0) (2024.6.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers==4.30.0) (4.12.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests->transformers==4.30.0) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers==4.30.0) (3.10)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers==4.30.0) (2.2.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers==4.30.0) (2024.8.30)\n","Downloading transformers-4.30.0-py3-none-any.whl (7.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m50.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m69.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: tokenizers, transformers\n","  Attempting uninstall: tokenizers\n","    Found existing installation: tokenizers 0.19.1\n","    Uninstalling tokenizers-0.19.1:\n","      Successfully uninstalled tokenizers-0.19.1\n","  Attempting uninstall: transformers\n","    Found existing installation: transformers 4.44.2\n","    Uninstalling transformers-4.44.2:\n","      Successfully uninstalled transformers-4.44.2\n","Successfully installed tokenizers-0.13.3 transformers-4.30.0\n"]}]},{"cell_type":"code","source":["!pip install --upgrade 'torch[dynamo]'"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"AMp0Of4vlHMB","executionInfo":{"status":"ok","timestamp":1728399116009,"user_tz":-300,"elapsed":216107,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"d7d54fc5-3226-43b2-e154-7d29873b06ba"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: torch[dynamo] in /usr/local/lib/python3.10/dist-packages (1.13.1)\n","Collecting torch[dynamo]\n","  Downloading torch-2.4.1-cp310-cp310-manylinux1_x86_64.whl.metadata (26 kB)\n","\u001b[33mWARNING: torch 2.4.1 does not provide the extra 'dynamo'\u001b[0m\u001b[33m\n","\u001b[0mRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch[dynamo]) (3.9.1)\n","Requirement already satisfied: typing-extensions>=4.8.0 in /usr/local/lib/python3.10/dist-packages (from torch[dynamo]) (4.12.2)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch[dynamo]) (1.13.3)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch[dynamo]) (3.3)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch[dynamo]) (3.1.4)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch[dynamo]) (2024.6.1)\n","Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch[dynamo])\n","  Downloading nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch[dynamo])\n","  Downloading nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch[dynamo])\n","  Downloading nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch[dynamo])\n","  Downloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cublas-cu12==12.1.3.1 (from torch[dynamo])\n","  Downloading nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cufft-cu12==11.0.2.54 (from torch[dynamo])\n","  Downloading nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-curand-cu12==10.3.2.106 (from torch[dynamo])\n","  Downloading nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)\n","Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch[dynamo])\n","  Downloading nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch[dynamo])\n","  Downloading nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)\n","Collecting nvidia-nccl-cu12==2.20.5 (from torch[dynamo])\n","  Downloading nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl.metadata (1.8 kB)\n","Collecting nvidia-nvtx-cu12==12.1.105 (from torch[dynamo])\n","  Downloading nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl.metadata (1.7 kB)\n","Collecting triton==3.0.0 (from torch[dynamo])\n","  Downloading triton-3.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.3 kB)\n","Requirement already satisfied: nvidia-nvjitlink-cu12 in /usr/local/lib/python3.10/dist-packages (from nvidia-cusolver-cu12==11.4.5.107->torch[dynamo]) (12.6.77)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch[dynamo]) (2.1.5)\n","Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.10/dist-packages (from sympy->torch[dynamo]) (1.3.0)\n","Downloading nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m410.6/410.6 MB\u001b[0m \u001b[31m4.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m14.1/14.1 MB\u001b[0m \u001b[31m64.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m23.7/23.7 MB\u001b[0m \u001b[31m57.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m823.6/823.6 kB\u001b[0m \u001b[31m29.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m664.8/664.8 MB\u001b[0m \u001b[31m2.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m121.6/121.6 MB\u001b[0m \u001b[31m7.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.5/56.5 MB\u001b[0m \u001b[31m12.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m124.2/124.2 MB\u001b[0m \u001b[31m7.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m196.0/196.0 MB\u001b[0m \u001b[31m6.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m176.2/176.2 MB\u001b[0m \u001b[31m7.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m99.1/99.1 kB\u001b[0m \u001b[31m5.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading triton-3.0.0-1-cp310-cp310-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (209.4 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m209.4/209.4 MB\u001b[0m \u001b[31m8.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading torch-2.4.1-cp310-cp310-manylinux1_x86_64.whl (797.1 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m797.1/797.1 MB\u001b[0m \u001b[31m2.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: triton, nvidia-nvtx-cu12, nvidia-nccl-cu12, nvidia-cusparse-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, nvidia-cusolver-cu12, nvidia-cudnn-cu12, torch\n","  Attempting uninstall: nvidia-nccl-cu12\n","    Found existing installation: nvidia-nccl-cu12 2.23.4\n","    Uninstalling nvidia-nccl-cu12-2.23.4:\n","      Successfully uninstalled nvidia-nccl-cu12-2.23.4\n","  Attempting uninstall: nvidia-cusparse-cu12\n","    Found existing installation: nvidia-cusparse-cu12 12.5.4.2\n","    Uninstalling nvidia-cusparse-cu12-12.5.4.2:\n","      Successfully uninstalled nvidia-cusparse-cu12-12.5.4.2\n","  Attempting uninstall: nvidia-cufft-cu12\n","    Found existing installation: nvidia-cufft-cu12 11.3.0.4\n","    Uninstalling nvidia-cufft-cu12-11.3.0.4:\n","      Successfully uninstalled nvidia-cufft-cu12-11.3.0.4\n","  Attempting uninstall: nvidia-cuda-runtime-cu12\n","    Found existing installation: nvidia-cuda-runtime-cu12 12.6.77\n","    Uninstalling nvidia-cuda-runtime-cu12-12.6.77:\n","      Successfully uninstalled nvidia-cuda-runtime-cu12-12.6.77\n","  Attempting uninstall: nvidia-cuda-cupti-cu12\n","    Found existing installation: nvidia-cuda-cupti-cu12 12.6.80\n","    Uninstalling nvidia-cuda-cupti-cu12-12.6.80:\n","      Successfully uninstalled nvidia-cuda-cupti-cu12-12.6.80\n","  Attempting uninstall: nvidia-cublas-cu12\n","    Found existing installation: nvidia-cublas-cu12 12.6.3.3\n","    Uninstalling nvidia-cublas-cu12-12.6.3.3:\n","      Successfully uninstalled nvidia-cublas-cu12-12.6.3.3\n","  Attempting uninstall: nvidia-cusolver-cu12\n","    Found existing installation: nvidia-cusolver-cu12 11.7.1.2\n","    Uninstalling nvidia-cusolver-cu12-11.7.1.2:\n","      Successfully uninstalled nvidia-cusolver-cu12-11.7.1.2\n","  Attempting uninstall: nvidia-cudnn-cu12\n","    Found existing installation: nvidia-cudnn-cu12 9.4.0.58\n","    Uninstalling nvidia-cudnn-cu12-9.4.0.58:\n","      Successfully uninstalled nvidia-cudnn-cu12-9.4.0.58\n","  Attempting uninstall: torch\n","    Found existing installation: torch 1.13.1\n","    Uninstalling torch-1.13.1:\n","      Successfully uninstalled torch-1.13.1\n","Successfully installed nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.20.5 nvidia-nvtx-cu12-12.1.105 torch-2.4.1 triton-3.0.0\n"]},{"output_type":"display_data","data":{"application/vnd.colab-display-data+json":{"pip_warning":{"packages":["torch","torchgen"]},"id":"ec775b78280445a8a2de6baae4c40509"}},"metadata":{}}]},{"cell_type":"code","source":["!pip install pytorch-crf"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1Se1jtmVmTv0","executionInfo":{"status":"ok","timestamp":1728398845092,"user_tz":-300,"elapsed":3774,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"b5d40d72-a77e-4d20-90f9-bc757047f1db"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting pytorch-crf\n","  Downloading pytorch_crf-0.7.2-py3-none-any.whl.metadata (2.4 kB)\n","Downloading pytorch_crf-0.7.2-py3-none-any.whl (9.5 kB)\n","Installing collected packages: pytorch-crf\n","Successfully installed pytorch-crf-0.7.2\n"]}]},{"cell_type":"code","execution_count":21,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"6jTj_aOabotP","executionInfo":{"status":"ok","timestamp":1728399161553,"user_tz":-300,"elapsed":34560,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"d886041d-660c-4a82-fb2c-75ed014ebd0d"},"outputs":[{"output_type":"stream","name":"stderr","text":["2024-10-08 14:52:23.744 INFO in 'deeppavlov.download'['download'] at line 138: Skipped http://files.deeppavlov.ai/deeppavlov_data/rus_dream_entity_detection/wiki_ner_rus_bert.tar.gz download because of matching hashes\n","INFO:deeppavlov.download:Skipped http://files.deeppavlov.ai/deeppavlov_data/rus_dream_entity_detection/wiki_ner_rus_bert.tar.gz download because of matching hashes\n","2024-10-08 14:52:25.664 INFO in 'deeppavlov.download'['download'] at line 138: Skipped http://files.deeppavlov.ai/datasets/wiki_ner_rus/wiki_ner_rus_dataset.tar.gz download because of matching hashes\n","INFO:deeppavlov.download:Skipped http://files.deeppavlov.ai/datasets/wiki_ner_rus/wiki_ner_rus_dataset.tar.gz download because of matching hashes\n","/usr/local/lib/python3.10/dist-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.\n","  warnings.warn(\n","/usr/local/lib/python3.10/dist-packages/transformers/modeling_utils.py:463: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  return torch.load(checkpoint_file, map_location=\"cpu\")\n","Some weights of the model checkpoint at DeepPavlov/rubert-base-cased were not used when initializing BertForTokenClassification: ['cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight', 'cls.predictions.bias', 'cls.predictions.decoder.weight', 'cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.decoder.bias']\n","- This IS expected if you are initializing BertForTokenClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing BertForTokenClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of BertForTokenClassification were not initialized from the model checkpoint at DeepPavlov/rubert-base-cased and are newly initialized: ['classifier.weight', 'classifier.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n","2024-10-08 14:52:34.326 WARNING in 'deeppavlov.core.models.torch_model'['torch_model'] at line 96: Unable to place component TorchTransformersSequenceTagger on GPU, since no CUDA GPUs are available. Using CPU.\n","WARNING:deeppavlov.core.models.torch_model:Unable to place component TorchTransformersSequenceTagger on GPU, since no CUDA GPUs are available. Using CPU.\n","/usr/local/lib/python3.10/dist-packages/deeppavlov/core/models/torch_model.py:134: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.\n","  checkpoint = torch.load(weights_path, map_location=self.device)\n"]},{"output_type":"execute_result","data":{"text/plain":["[[['Нью',\n","   '-',\n","   'Йорк',\n","   ',',\n","   'США',\n","   ',',\n","   '30',\n","   'апреля',\n","   '2020',\n","   ',',\n","   '01:01',\n","   '—',\n","   'REGNUM',\n","   'В',\n","   'администрации',\n","   'президента',\n","   'США',\n","   'Дональда',\n","   'Трампа',\n","   'планируют',\n","   'пройти',\n","   'все',\n","   'этапы',\n","   'создания',\n","   'вакцины',\n","   'от',\n","   'коронавируса',\n","   'в',\n","   'ускоренном',\n","   'темпе',\n","   'и',\n","   'выпустить',\n","   '100',\n","   'млн',\n","   'доз',\n","   'до',\n","   'конца',\n","   '2020',\n","   'года',\n","   ',',\n","   'передаёт',\n","   'агентство',\n","   'Bloomberg',\n","   'со',\n","   'ссылкой',\n","   'на',\n","   'осведомлённые',\n","   'источники']],\n"," [[(0, 3),\n","   (3, 4),\n","   (4, 8),\n","   (8, 9),\n","   (10, 13),\n","   (13, 14),\n","   (15, 17),\n","   (18, 24),\n","   (25, 29),\n","   (29, 30),\n","   (31, 36),\n","   (37, 38),\n","   (39, 45),\n","   (46, 47),\n","   (48, 61),\n","   (62, 72),\n","   (73, 76),\n","   (77, 85),\n","   (86, 92),\n","   (93, 102),\n","   (103, 109),\n","   (110, 113),\n","   (114, 119),\n","   (120, 128),\n","   (129, 136),\n","   (137, 139),\n","   (140, 152),\n","   (153, 154),\n","   (155, 165),\n","   (166, 171),\n","   (172, 173),\n","   (174, 183),\n","   (184, 187),\n","   (188, 191),\n","   (192, 195),\n","   (196, 198),\n","   (199, 204),\n","   (205, 209),\n","   (210, 214),\n","   (214, 215),\n","   (216, 224),\n","   (225, 234),\n","   (235, 244),\n","   (245, 247),\n","   (248, 255),\n","   (256, 258),\n","   (259, 272),\n","   (273, 282)]],\n"," [['B-CITY',\n","   'I-CITY',\n","   'I-CITY',\n","   'O',\n","   'B-LOC',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'B-ORG',\n","   'O',\n","   'O',\n","   'O',\n","   'B-LOC',\n","   'B-PER',\n","   'I-PER',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'B-ORG',\n","   'O',\n","   'O',\n","   'O',\n","   'O',\n","   'O']],\n"," array([[[2.23797720e-04, 3.00804607e-04, 1.29306690e-04, ...,\n","          1.09032731e-04, 4.68877862e-05, 4.65174567e-05],\n","         [1.97353464e-04, 8.13125768e-05, 5.23517251e-04, ...,\n","          1.28669984e-04, 3.43859724e-04, 1.43489234e-04],\n","         [1.04214356e-04, 8.84667119e-05, 5.35194946e-04, ...,\n","          1.33350717e-04, 3.08556434e-04, 1.36286933e-04],\n","         ...,\n","         [9.99775534e-01, 1.79372388e-05, 1.34465597e-06, ...,\n","          3.06240007e-06, 2.58183162e-07, 7.09635124e-08],\n","         [9.99718378e-01, 2.15535622e-05, 1.42323019e-06, ...,\n","          5.27255781e-06, 2.93650298e-07, 7.67255384e-08],\n","         [9.99741634e-01, 2.33816249e-05, 2.88604423e-06, ...,\n","          3.20727013e-06, 3.45189341e-07, 8.47012250e-08]]])]"]},"metadata":{},"execution_count":21}],"source":["# !python -m venv env\n","# #.\\env\\Scripts\\activate.bat\n","# !pip install deeppavlov\n","# !python -m deeppavlov install squad_bert\n","\n","#!python -m deeppavlov install ner_ontonotes\n","import deeppavlov\n","from deeppavlov import configs, build_model\n","deeppavlov_ner = build_model(configs.ner.ner_rus_bert_probas, download=True)\n","rus_document = \"Нью-Йорк, США, 30 апреля 2020, 01:01 — REGNUM В администрации президента США Дональда Трампа планируют пройти все этапы создания вакцины от коронавируса в ускоренном темпе и выпустить 100 млн доз до конца 2020 года, передаёт агентство Bloomberg со ссылкой на осведомлённые источники\"\n","deeppavlov_ner([rus_document])"]},{"cell_type":"markdown","metadata":{"id":"QTPPRsGvbotP"},"source":["### Извлечение отношений\n","\n","Можно извлекать не только именнованные сущности (NER), но и отношения между словами в предложении (Relation extraction)."]},{"cell_type":"markdown","metadata":{"id":"mWoIThoTbotP"},"source":["#### Spacy\n","\n","В уже знакомой нам библеотеке Spacy используем встроенные displaCy визуализатор со style=\"dep\" для отображения отношений."]},{"cell_type":"code","execution_count":22,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/","height":563},"id":"SepikbP-botP","executionInfo":{"status":"ok","timestamp":1728399162881,"user_tz":-300,"elapsed":1331,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"460172ad-51d7-4e99-97d9-1b46d2e45d49"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<span class=\"tex2jax_ignore\"><svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xml:lang=\"en\" id=\"96b700cf794c4eecb992c6b429d37e39-0\" class=\"displacy\" width=\"3200\" height=\"487.0\" direction=\"ltr\" style=\"max-width: none; height: 487.0px; color: #000000; background: #ffffff; font-family: Arial; direction: ltr\">\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"50\">I</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"50\">PRON</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"225\">think</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"225\">VERB</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"400\">Barack</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"400\">PROPN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"575\">Obama</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"575\">PROPN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"750\">met</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"750\">VERB</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"925\">founder</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"925\">NOUN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"1100\">of</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"1100\">ADP</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"1275\">Facebook</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"1275\">PROPN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"1450\">at</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"1450\">ADP</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"1625\">occasion</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"1625\">NOUN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"1800\">of</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"1800\">ADP</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"1975\">a</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"1975\">DET</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"2150\">release</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"2150\">NOUN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"2325\">of</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"2325\">ADP</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"2500\">a</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"2500\">DET</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"2675\">new</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"2675\">ADJ</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"2850\">NLP</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"2850\">PROPN</tspan>\n","</text>\n","\n","<text class=\"displacy-token\" fill=\"currentColor\" text-anchor=\"middle\" y=\"397.0\">\n","    <tspan class=\"displacy-word\" fill=\"currentColor\" x=\"3025\">algorithm.</tspan>\n","    <tspan class=\"displacy-tag\" dy=\"2em\" fill=\"currentColor\" x=\"3025\">PROPN</tspan>\n","</text>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-0\" stroke-width=\"2px\" d=\"M70,352.0 C70,264.5 210.0,264.5 210.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-0\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">nsubj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M70,354.0 L62,342.0 78,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-1\" stroke-width=\"2px\" d=\"M420,352.0 C420,264.5 560.0,264.5 560.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-1\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">compound</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M420,354.0 L412,342.0 428,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-2\" stroke-width=\"2px\" d=\"M595,352.0 C595,264.5 735.0,264.5 735.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-2\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">nsubj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M595,354.0 L587,342.0 603,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-3\" stroke-width=\"2px\" d=\"M245,352.0 C245,177.0 740.0,177.0 740.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-3\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">ccomp</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M740.0,354.0 L748.0,342.0 732.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-4\" stroke-width=\"2px\" d=\"M770,352.0 C770,264.5 910.0,264.5 910.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-4\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">dobj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M910.0,354.0 L918.0,342.0 902.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-5\" stroke-width=\"2px\" d=\"M945,352.0 C945,264.5 1085.0,264.5 1085.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-5\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">prep</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M1085.0,354.0 L1093.0,342.0 1077.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-6\" stroke-width=\"2px\" d=\"M1120,352.0 C1120,264.5 1260.0,264.5 1260.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-6\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">pobj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M1260.0,354.0 L1268.0,342.0 1252.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-7\" stroke-width=\"2px\" d=\"M770,352.0 C770,177.0 1440.0,177.0 1440.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-7\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">prep</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M1440.0,354.0 L1448.0,342.0 1432.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-8\" stroke-width=\"2px\" d=\"M1470,352.0 C1470,264.5 1610.0,264.5 1610.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-8\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">pobj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M1610.0,354.0 L1618.0,342.0 1602.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-9\" stroke-width=\"2px\" d=\"M1645,352.0 C1645,264.5 1785.0,264.5 1785.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-9\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">prep</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M1785.0,354.0 L1793.0,342.0 1777.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-10\" stroke-width=\"2px\" d=\"M1995,352.0 C1995,264.5 2135.0,264.5 2135.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-10\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">det</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M1995,354.0 L1987,342.0 2003,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-11\" stroke-width=\"2px\" d=\"M1820,352.0 C1820,177.0 2140.0,177.0 2140.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-11\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">pobj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M2140.0,354.0 L2148.0,342.0 2132.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-12\" stroke-width=\"2px\" d=\"M2170,352.0 C2170,264.5 2310.0,264.5 2310.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-12\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">prep</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M2310.0,354.0 L2318.0,342.0 2302.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-13\" stroke-width=\"2px\" d=\"M2520,352.0 C2520,89.5 3020.0,89.5 3020.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-13\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">det</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M2520,354.0 L2512,342.0 2528,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-14\" stroke-width=\"2px\" d=\"M2695,352.0 C2695,177.0 3015.0,177.0 3015.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-14\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">amod</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M2695,354.0 L2687,342.0 2703,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-15\" stroke-width=\"2px\" d=\"M2870,352.0 C2870,264.5 3010.0,264.5 3010.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-15\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">compound</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M2870,354.0 L2862,342.0 2878,342.0\" fill=\"currentColor\"/>\n","</g>\n","\n","<g class=\"displacy-arrow\">\n","    <path class=\"displacy-arc\" id=\"arrow-96b700cf794c4eecb992c6b429d37e39-0-16\" stroke-width=\"2px\" d=\"M2345,352.0 C2345,2.0 3025.0,2.0 3025.0,352.0\" fill=\"none\" stroke=\"currentColor\"/>\n","    <text dy=\"1.25em\" style=\"font-size: 0.8em; letter-spacing: 1px\">\n","        <textPath xlink:href=\"#arrow-96b700cf794c4eecb992c6b429d37e39-0-16\" class=\"displacy-label\" startOffset=\"50%\" side=\"left\" fill=\"currentColor\" text-anchor=\"middle\">pobj</textPath>\n","    </text>\n","    <path class=\"displacy-arrowhead\" d=\"M3025.0,354.0 L3033.0,342.0 3017.0,342.0\" fill=\"currentColor\"/>\n","</g>\n","</svg></span>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<span class=\"tex2jax_ignore\"><div class=\"entities\" style=\"line-height: 2.5; direction: ltr\">I think \n","<mark class=\"entity\" style=\"background: #aa9cfc; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    Barack Obama\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">PERSON</span>\n","</mark>\n"," met founder of Facebook at occasion of a release of a new \n","<mark class=\"entity\" style=\"background: #7aecec; padding: 0.45em 0.6em; margin: 0 0.25em; line-height: 1; border-radius: 0.35em;\">\n","    NLP\n","    <span style=\"font-size: 0.8em; font-weight: bold; line-height: 1; border-radius: 0.35em; vertical-align: middle; margin-left: 0.5rem\">ORG</span>\n","</mark>\n"," algorithm.</div></span>"]},"metadata":{}}],"source":["import spacy\n","from spacy import displacy\n","#install spacy model\n","#!pip install https://github.com/explosion/spacy-models/releases/download/en_core_web_md-2.2.0/en_core_web_md-2.2.0.tar.gz\n","import en_core_web_sm\n","nlp = en_core_web_sm.load()\n","doc = nlp(\"I think Barack Obama met founder of Facebook at occasion of a release of a new NLP algorithm.\")\n","\n","displacy.render(doc, style=\"dep\") # (1)\n","displacy.render(doc, style=\"ent\") # (2)"]},{"cell_type":"markdown","metadata":{"id":"4N8KPF9zbotQ"},"source":["#### NLTK\n","\n","Распарсим документ nltk.corpus.ieer.parsed_docs('NYT_19980315'), extract_rels позволяет нам выделять необходимые отношения, в данном случае мы ищем пары сущностей <'ORG', 'LOC'>. Также мы указали, что текст должен подходить под регулярное выражение IN."]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CaBYeoLtbotQ","executionInfo":{"status":"ok","timestamp":1728399162881,"user_tz":-300,"elapsed":7,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"02c04741-758c-469f-84a5-326d82130c59"},"outputs":[{"output_type":"stream","name":"stdout","text":["[ORG: 'WHYY'] 'in' [LOC: 'Philadelphia']\n","[ORG: 'McGlashan &AMP; Sarrail'] 'firm in' [LOC: 'San Mateo']\n","[ORG: 'Freedom Forum'] 'in' [LOC: 'Arlington']\n","[ORG: 'Brookings Institution'] ', the research group in' [LOC: 'Washington']\n","[ORG: 'Idealab'] ', a self-described business incubator based in' [LOC: 'Los Angeles']\n","[ORG: 'Open Text'] ', based in' [LOC: 'Waterloo']\n","[ORG: 'WGBH'] 'in' [LOC: 'Boston']\n","[ORG: 'Bastille Opera'] 'in' [LOC: 'Paris']\n","[ORG: 'Omnicom'] 'in' [LOC: 'New York']\n","[ORG: 'DDB Needham'] 'in' [LOC: 'New York']\n","[ORG: 'Kaplan Thaler Group'] 'in' [LOC: 'New York']\n","[ORG: 'BBDO South'] 'in' [LOC: 'Atlanta']\n","[ORG: 'Georgia-Pacific'] 'in' [LOC: 'Atlanta']\n"]}],"source":["import re\n","import nltk\n","IN = re.compile(r'.*\\bin\\b(?!\\b.+ing)')\n","for doc in nltk.corpus.ieer.parsed_docs('NYT_19980315'):\n","     for rel in nltk.sem.extract_rels('ORG', 'LOC', doc,\n","                                      corpus='ieer', pattern = IN):\n","            print(nltk.sem.rtuple(rel))"]},{"cell_type":"markdown","metadata":{"id":"mbSf3OfwbotQ"},"source":["#### Allennlp\n","\n","Попробовать извлекать отношения онлайн можно с помощью демо Allennlp  https://demo.allennlp.org/dependency-parsing/.\n","Allen NLP предлагает две модели NER с различными архитектурами: Gated Recurrent Unit (GRU) Network, bi-LSTM-CRF model."]},{"cell_type":"markdown","metadata":{"id":"tSn6aowdbotQ"},"source":["<img src='image/allennlp.PNG'>"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kqDzQq3NbotQ","executionInfo":{"status":"ok","timestamp":1728399171414,"user_tz":-300,"elapsed":8537,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"fd725add-8950-485b-9492-c50d7ff6219b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting pymorphy2\n","  Downloading pymorphy2-0.9.1-py3-none-any.whl.metadata (3.6 kB)\n","Collecting dawg-python>=0.7.1 (from pymorphy2)\n","  Downloading DAWG_Python-0.7.2-py2.py3-none-any.whl.metadata (7.0 kB)\n","Collecting pymorphy2-dicts-ru<3.0,>=2.4 (from pymorphy2)\n","  Downloading pymorphy2_dicts_ru-2.4.417127.4579844-py2.py3-none-any.whl.metadata (2.1 kB)\n","Collecting docopt>=0.6 (from pymorphy2)\n","  Downloading docopt-0.6.2.tar.gz (25 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Downloading pymorphy2-0.9.1-py3-none-any.whl (55 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m55.5/55.5 kB\u001b[0m \u001b[31m1.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading DAWG_Python-0.7.2-py2.py3-none-any.whl (11 kB)\n","Downloading pymorphy2_dicts_ru-2.4.417127.4579844-py2.py3-none-any.whl (8.2 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m8.2/8.2 MB\u001b[0m \u001b[31m53.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hBuilding wheels for collected packages: docopt\n","  Building wheel for docopt (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for docopt: filename=docopt-0.6.2-py2.py3-none-any.whl size=13704 sha256=21c6b5d014b73e78b05296bb4efb308640005a77dd95ad774f80689120d29dd6\n","  Stored in directory: /root/.cache/pip/wheels/fc/ab/d4/5da2067ac95b36618c629a5f93f809425700506f72c9732fac\n","Successfully built docopt\n","Installing collected packages: pymorphy2-dicts-ru, docopt, dawg-python, pymorphy2\n","Successfully installed dawg-python-0.7.2 docopt-0.6.2 pymorphy2-0.9.1 pymorphy2-dicts-ru-2.4.417127.4579844\n"]}],"source":["!pip install pymorphy2"]},{"cell_type":"code","execution_count":25,"metadata":{"id":"78N19DCwbotQ","executionInfo":{"status":"ok","timestamp":1728399171414,"user_tz":-300,"elapsed":16,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["from pymorphy2 import MorphAnalyzer"]},{"cell_type":"code","execution_count":26,"metadata":{"id":"j64oHCaYbotR","executionInfo":{"status":"ok","timestamp":1728399171736,"user_tz":-300,"elapsed":337,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["morpher = MorphAnalyzer()"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cxf3jxCzbotR","executionInfo":{"status":"ok","timestamp":1728399171736,"user_tz":-300,"elapsed":6,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"01c56eaf-3400-4861-b25a-617440a638b9"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Parse(word='кошка', tag=OpencorporaTag('NOUN,anim,femn sing,nomn'), normal_form='кошка', score=0.9375, methods_stack=((DictionaryAnalyzer(), 'кошка', 134, 0),))"]},"metadata":{},"execution_count":27}],"source":["morpher.parse(\"кошка\")[0]"]},{"cell_type":"code","execution_count":28,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1Zx4FUDRbotR","executionInfo":{"status":"ok","timestamp":1728399186278,"user_tz":-300,"elapsed":14545,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"6bf247db-7154-4d65-b22d-d0537a1aa85e"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting natasha\n","  Downloading natasha-1.6.0-py3-none-any.whl.metadata (23 kB)\n","Requirement already satisfied: pymorphy2 in /usr/local/lib/python3.10/dist-packages (from natasha) (0.9.1)\n","Collecting razdel>=0.5.0 (from natasha)\n","  Downloading razdel-0.5.0-py3-none-any.whl.metadata (10.0 kB)\n","Collecting navec>=0.9.0 (from natasha)\n","  Downloading navec-0.10.0-py3-none-any.whl.metadata (21 kB)\n","Collecting slovnet>=0.6.0 (from natasha)\n","  Downloading slovnet-0.6.0-py3-none-any.whl.metadata (34 kB)\n","Collecting yargy>=0.16.0 (from natasha)\n","  Downloading yargy-0.16.0-py3-none-any.whl.metadata (3.5 kB)\n","Collecting ipymarkup>=0.8.0 (from natasha)\n","  Downloading ipymarkup-0.9.0-py3-none-any.whl.metadata (5.6 kB)\n","Collecting intervaltree>=3 (from ipymarkup>=0.8.0->natasha)\n","  Downloading intervaltree-3.1.0.tar.gz (32 kB)\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from navec>=0.9.0->natasha) (1.23.5)\n","Requirement already satisfied: dawg-python>=0.7.1 in /usr/local/lib/python3.10/dist-packages (from pymorphy2->natasha) (0.7.2)\n","Requirement already satisfied: pymorphy2-dicts-ru<3.0,>=2.4 in /usr/local/lib/python3.10/dist-packages (from pymorphy2->natasha) (2.4.417127.4579844)\n","Requirement already satisfied: docopt>=0.6 in /usr/local/lib/python3.10/dist-packages (from pymorphy2->natasha) (0.6.2)\n","Requirement already satisfied: sortedcontainers<3.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from intervaltree>=3->ipymarkup>=0.8.0->natasha) (2.4.0)\n","Downloading natasha-1.6.0-py3-none-any.whl (34.4 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m34.4/34.4 MB\u001b[0m \u001b[31m18.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading ipymarkup-0.9.0-py3-none-any.whl (14 kB)\n","Downloading navec-0.10.0-py3-none-any.whl (23 kB)\n","Downloading razdel-0.5.0-py3-none-any.whl (21 kB)\n","Downloading slovnet-0.6.0-py3-none-any.whl (46 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m46.7/46.7 kB\u001b[0m \u001b[31m2.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading yargy-0.16.0-py3-none-any.whl (33 kB)\n","Building wheels for collected packages: intervaltree\n","  Building wheel for intervaltree (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for intervaltree: filename=intervaltree-3.1.0-py2.py3-none-any.whl size=26096 sha256=9f7330655d4d7e3f8133e89d71a18d5c43ceb56a2855c5ff57a4b4bcfecf4a65\n","  Stored in directory: /root/.cache/pip/wheels/fa/80/8c/43488a924a046b733b64de3fac99252674c892a4c3801c0a61\n","Successfully built intervaltree\n","Installing collected packages: razdel, navec, intervaltree, yargy, slovnet, ipymarkup, natasha\n","Successfully installed intervaltree-3.1.0 ipymarkup-0.9.0 natasha-1.6.0 navec-0.10.0 razdel-0.5.0 slovnet-0.6.0 yargy-0.16.0\n"]}],"source":["!pip install natasha"]},{"cell_type":"code","execution_count":29,"metadata":{"id":"esNAJbBgbotR","executionInfo":{"status":"ok","timestamp":1728399186279,"user_tz":-300,"elapsed":18,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["from natasha import (\n","    Segmenter,\n","    MorphVocab,\n","\n","    NewsEmbedding,\n","    NewsMorphTagger,\n","    NewsSyntaxParser,\n","    NewsNERTagger,\n","\n","    PER,\n","    NamesExtractor,\n","\n","    Doc\n",")"]},{"cell_type":"code","execution_count":30,"metadata":{"id":"uCaCYdJebotR","executionInfo":{"status":"ok","timestamp":1728399189692,"user_tz":-300,"elapsed":3430,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["segmenter = Segmenter()\n","morph_vocab = MorphVocab()\n","\n","emb = NewsEmbedding()\n","morph_tagger = NewsMorphTagger(emb)\n","syntax_parser = NewsSyntaxParser(emb)\n","ner_tagger = NewsNERTagger(emb)\n","\n","names_extractor = NamesExtractor(morph_vocab)\n","\n","text = 'Посол Израиля на Украине Йоэль Лион признался, что пришел в шок, узнав о решении властей Львовской области объявить 2019 год годом лидера запрещенной в России Организации украинских националистов (ОУН) Степана Бандеры. Свое заявление он разместил в Twitter. «Я не могу понять, как прославление тех, кто непосредственно принимал участие в ужасных антисемитских преступлениях, помогает бороться с антисемитизмом и ксенофобией. Украина не должна забывать о преступлениях, совершенных против украинских евреев, и никоим образом не отмечать их через почитание их исполнителей», — написал дипломат. 11 декабря Львовский областной совет принял решение провозгласить 2019 год в регионе годом Степана Бандеры в связи с празднованием 110-летия со дня рождения лидера ОУН (Бандера родился 1 января 1909 года). В июле аналогичное решение принял Житомирский областной совет. В начале месяца с предложением к президенту страны Петру Порошенко вернуть Бандере звание Героя Украины обратились депутаты Верховной Рады. Парламентарии уверены, что признание Бандеры национальным героем поможет в борьбе с подрывной деятельностью против Украины в информационном поле, а также остановит «распространение мифов, созданных российской пропагандой». Степан Бандера (1909-1959) был одним из лидеров Организации украинских националистов, выступающей за создание независимого государства на территориях с украиноязычным населением. В 2010 году в период президентства Виктора Ющенко Бандера был посмертно признан Героем Украины, однако впоследствии это решение было отменено судом. '\n","doc = Doc(text)"]},{"cell_type":"code","execution_count":31,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":191},"id":"Ik6RJsLtbotS","executionInfo":{"status":"ok","timestamp":1728399189692,"user_tz":-300,"elapsed":15,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"3f66c9f6-31aa-4a72-9b9c-be1b3d37d1e1"},"outputs":[{"output_type":"display_data","data":{"text/plain":["[DocToken(stop=5, text='Посол'),\n"," DocToken(start=6, stop=13, text='Израиля'),\n"," DocToken(start=14, stop=16, text='на'),\n"," DocToken(start=17, stop=24, text='Украине'),\n"," DocToken(start=25, stop=30, text='Йоэль')]"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["[DocSent(stop=218, text='Посол Израиля на Украине Йоэль Лион признался, чт..., tokens=[...]),\n"," DocSent(start=219, stop=257, text='Свое заявление он разместил в Twitter.', tokens=[...]),\n"," DocSent(start=258, stop=424, text='«Я не могу понять, как прославление тех, кто непо..., tokens=[...]),\n"," DocSent(start=425, stop=592, text='Украина не должна забывать о преступлениях, совер..., tokens=[...]),\n"," DocSent(start=593, stop=798, text='11 декабря Львовский областной совет принял решен..., tokens=[...])]"]},"metadata":{}}],"source":["doc.segment(segmenter)\n","display(doc.tokens[:5])\n","display(doc.sents[:5])"]},{"cell_type":"code","execution_count":31,"metadata":{"id":"ZCEZXeYSbotS","executionInfo":{"status":"ok","timestamp":1728399189693,"user_tz":-300,"elapsed":14,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":[]},{"cell_type":"code","execution_count":31,"metadata":{"id":"0ac_QGq5botS","executionInfo":{"status":"ok","timestamp":1728399189693,"user_tz":-300,"elapsed":14,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"rR6J_YsebotS"},"source":["много дополнительных датасетов на русском языке\n","\n","https://natasha.github.io/corus/  \n","https://github.com/natasha/corus"]},{"cell_type":"code","execution_count":34,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"8HIcE7L7botT","executionInfo":{"status":"ok","timestamp":1728399204502,"user_tz":-300,"elapsed":8326,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"5d0b7b45-2d19-4b5f-d9da-97c3fdf5e22f"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting corus\n","  Downloading corus-0.10.0-py3-none-any.whl.metadata (31 kB)\n","Downloading corus-0.10.0-py3-none-any.whl (83 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m83.7/83.7 kB\u001b[0m \u001b[31m3.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: corus\n","Successfully installed corus-0.10.0\n"]}],"source":["!pip install corus"]},{"cell_type":"code","execution_count":35,"metadata":{"id":"y4kAwvHzbotT","executionInfo":{"status":"ok","timestamp":1728399204503,"user_tz":-300,"elapsed":5,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["import corus"]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"77Ze18AlbotT","executionInfo":{"status":"ok","timestamp":1728399206395,"user_tz":-300,"elapsed":1896,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"2946cf68-fbaf-4bb1-e394-4deb4b57c43e"},"outputs":[{"output_type":"stream","name":"stdout","text":["--2024-10-08 14:53:24--  http://www.labinform.ru/pub/named_entities/collection5.zip\n","Resolving www.labinform.ru (www.labinform.ru)... 95.181.230.181\n","Connecting to www.labinform.ru (www.labinform.ru)|95.181.230.181|:80... connected.\n","HTTP request sent, awaiting response... 200 OK\n","Length: 1899530 (1.8M) [application/zip]\n","Saving to: ‘collection5.zip’\n","\n","collection5.zip     100%[===================>]   1.81M  1.95MB/s    in 0.9s    \n","\n","2024-10-08 14:53:26 (1.95 MB/s) - ‘collection5.zip’ saved [1899530/1899530]\n","\n"]}],"source":["!wget http://www.labinform.ru/pub/named_entities/collection5.zip"]},{"cell_type":"code","execution_count":37,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"ellgmnaxbotU","executionInfo":{"status":"ok","timestamp":1728399207105,"user_tz":-300,"elapsed":714,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"8daeaeb1-1ee6-4f07-ee1e-75716fc66e07"},"outputs":[{"output_type":"stream","name":"stdout","text":["Archive:  collection5.zip\n","   creating: Collection5/\n","  inflating: Collection5/001.ann     \n","  inflating: Collection5/001.txt     \n","  inflating: Collection5/002.ann     \n","  inflating: Collection5/002.txt     \n","  inflating: Collection5/003.ann     \n","  inflating: Collection5/003.txt     \n","  inflating: Collection5/004.ann     \n","  inflating: Collection5/004.txt     \n","  inflating: Collection5/005.ann     \n","  inflating: Collection5/005.txt     \n","  inflating: Collection5/006.ann     \n","  inflating: Collection5/006.txt     \n","  inflating: Collection5/007.ann     \n","  inflating: Collection5/007.txt     \n","  inflating: Collection5/008.ann     \n","  inflating: Collection5/008.txt     \n","  inflating: Collection5/009.ann     \n","  inflating: Collection5/009.txt     \n","  inflating: Collection5/010.ann     \n","  inflating: Collection5/010.txt     \n","  inflating: Collection5/011.ann     \n","  inflating: Collection5/011.txt     \n","  inflating: Collection5/012.ann     \n","  inflating: Collection5/012.txt     \n","  inflating: Collection5/013.ann     \n","  inflating: Collection5/013.txt     \n","  inflating: Collection5/014.ann     \n","  inflating: Collection5/014.txt     \n","  inflating: Collection5/015 (!).ann  \n","  inflating: Collection5/015 (!).txt  \n","  inflating: Collection5/016.ann     \n","  inflating: Collection5/016.txt     \n","  inflating: Collection5/017.ann     \n","  inflating: Collection5/017.txt     \n","  inflating: Collection5/018.ann     \n","  inflating: Collection5/018.txt     \n","  inflating: Collection5/019.ann     \n","  inflating: Collection5/019.txt     \n","  inflating: Collection5/020.ann     \n","  inflating: Collection5/020.txt     \n","  inflating: Collection5/021.ann     \n","  inflating: Collection5/021.txt     \n","  inflating: Collection5/022.ann     \n","  inflating: Collection5/022.txt     \n","  inflating: Collection5/023.ann     \n","  inflating: Collection5/023.txt     \n","  inflating: Collection5/025.ann     \n","  inflating: Collection5/025.txt     \n","  inflating: Collection5/026.ann     \n","  inflating: Collection5/026.txt     \n","  inflating: Collection5/027.ann     \n","  inflating: Collection5/027.txt     \n","  inflating: Collection5/028.ann     \n","  inflating: Collection5/028.txt     \n","  inflating: Collection5/029.ann     \n","  inflating: Collection5/029.txt     \n","  inflating: Collection5/030.ann     \n","  inflating: Collection5/030.txt     \n","  inflating: Collection5/031.ann     \n","  inflating: Collection5/031.txt     \n","  inflating: Collection5/032.ann     \n","  inflating: Collection5/032.txt     \n","  inflating: Collection5/033.ann     \n","  inflating: Collection5/033.txt     \n","  inflating: Collection5/034.ann     \n","  inflating: Collection5/034.txt     \n","  inflating: Collection5/035.ann     \n","  inflating: Collection5/035.txt     \n","  inflating: Collection5/036.ann     \n","  inflating: Collection5/036.txt     \n","  inflating: Collection5/037.ann     \n","  inflating: Collection5/037.txt     \n","  inflating: Collection5/038.ann     \n","  inflating: Collection5/038.txt     \n","  inflating: Collection5/039.ann     \n","  inflating: Collection5/039.txt     \n","  inflating: Collection5/03_12_12a.ann  \n","  inflating: Collection5/03_12_12a.txt  \n","  inflating: Collection5/03_12_12b.ann  \n","  inflating: Collection5/03_12_12b.txt  \n","  inflating: Collection5/03_12_12c.ann  \n","  inflating: Collection5/03_12_12c.txt  \n","  inflating: Collection5/03_12_12d.ann  \n","  inflating: Collection5/03_12_12d.txt  \n","  inflating: Collection5/03_12_12g.ann  \n","  inflating: Collection5/03_12_12g.txt  \n","  inflating: Collection5/03_12_12h.ann  \n","  inflating: Collection5/03_12_12h.txt  \n","  inflating: Collection5/040.ann     \n","  inflating: Collection5/040.txt     \n","  inflating: Collection5/041.ann     \n","  inflating: Collection5/041.txt     \n","  inflating: Collection5/042.ann     \n","  inflating: Collection5/042.txt     \n","  inflating: Collection5/043.ann     \n","  inflating: Collection5/043.txt     \n","  inflating: Collection5/044.ann     \n","  inflating: Collection5/044.txt     \n","  inflating: Collection5/045.ann     \n","  inflating: Collection5/045.txt     \n","  inflating: Collection5/046.ann     \n","  inflating: Collection5/046.txt     \n","  inflating: Collection5/047.ann     \n","  inflating: Collection5/047.txt     \n","  inflating: Collection5/048.ann     \n","  inflating: Collection5/048.txt     \n","  inflating: Collection5/049.ann     \n","  inflating: Collection5/049.txt     \n","  inflating: Collection5/04_02_13a_abdulatipov.ann  \n","  inflating: Collection5/04_02_13a_abdulatipov.txt  \n","  inflating: Collection5/04_03_13a_sorokin.ann  \n","  inflating: Collection5/04_03_13a_sorokin.txt  \n","  inflating: Collection5/04_12_12b.ann  \n","  inflating: Collection5/04_12_12b.txt  \n","  inflating: Collection5/04_12_12d.ann  \n","  inflating: Collection5/04_12_12d.txt  \n","  inflating: Collection5/04_12_12f.ann  \n","  inflating: Collection5/04_12_12f.txt  \n","  inflating: Collection5/04_12_12g.ann  \n","  inflating: Collection5/04_12_12g.txt  \n","  inflating: Collection5/04_12_12h_corr.ann  \n","  inflating: Collection5/04_12_12h_corr.txt  \n","  inflating: Collection5/050.ann     \n","  inflating: Collection5/050.txt     \n","  inflating: Collection5/051.ann     \n","  inflating: Collection5/051.txt     \n","  inflating: Collection5/052.ann     \n","  inflating: Collection5/052.txt     \n","  inflating: Collection5/053.ann     \n","  inflating: Collection5/053.txt     \n","  inflating: Collection5/054.ann     \n","  inflating: Collection5/054.txt     \n","  inflating: Collection5/055.ann     \n","  inflating: Collection5/055.txt     \n","  inflating: Collection5/056.ann     \n","  inflating: Collection5/056.txt     \n","  inflating: Collection5/057.ann     \n","  inflating: Collection5/057.txt     \n","  inflating: Collection5/058.ann     \n","  inflating: Collection5/058.txt     \n","  inflating: Collection5/059.ann     \n","  inflating: Collection5/059.txt     \n","  inflating: Collection5/060.ann     \n","  inflating: Collection5/060.txt     \n","  inflating: Collection5/061.ann     \n","  inflating: Collection5/061.txt     \n","  inflating: Collection5/062.ann     \n","  inflating: Collection5/062.txt     \n","  inflating: Collection5/063.ann     \n","  inflating: Collection5/063.txt     \n","  inflating: Collection5/064.ann     \n","  inflating: Collection5/064.txt     \n","  inflating: Collection5/065.ann     \n","  inflating: Collection5/065.txt     \n","  inflating: Collection5/066.ann     \n","  inflating: Collection5/066.txt     \n","  inflating: Collection5/067.ann     \n","  inflating: Collection5/067.txt     \n","  inflating: Collection5/068.ann     \n","  inflating: Collection5/068.txt     \n","  inflating: Collection5/069.ann     \n","  inflating: Collection5/069.txt     \n","  inflating: Collection5/070.ann     \n","  inflating: Collection5/070.txt     \n","  inflating: Collection5/071.ann     \n","  inflating: Collection5/071.txt     \n","  inflating: Collection5/072.ann     \n","  inflating: Collection5/072.txt     \n","  inflating: Collection5/073.ann     \n","  inflating: Collection5/073.txt     \n","  inflating: Collection5/074.ann     \n","  inflating: Collection5/074.txt     \n","  inflating: Collection5/075.ann     \n","  inflating: Collection5/075.txt     \n","  inflating: Collection5/076.ann     \n","  inflating: Collection5/076.txt     \n","  inflating: Collection5/077.ann     \n","  inflating: Collection5/077.txt     \n","  inflating: Collection5/078.ann     \n","  inflating: Collection5/078.txt     \n","  inflating: Collection5/079.ann     \n","  inflating: Collection5/079.txt     \n","  inflating: Collection5/080.ann     \n","  inflating: Collection5/080.txt     \n","  inflating: Collection5/081.ann     \n","  inflating: Collection5/081.txt     \n","  inflating: Collection5/082.ann     \n","  inflating: Collection5/082.txt     \n","  inflating: Collection5/083.ann     \n","  inflating: Collection5/083.txt     \n","  inflating: Collection5/084.ann     \n","  inflating: Collection5/084.txt     \n","  inflating: Collection5/085.ann     \n","  inflating: Collection5/085.txt     \n","  inflating: Collection5/086.ann     \n","  inflating: Collection5/086.txt     \n","  inflating: Collection5/087.ann     \n","  inflating: Collection5/087.txt     \n","  inflating: Collection5/088.ann     \n","  inflating: Collection5/088.txt     \n","  inflating: Collection5/089.ann     \n","  inflating: Collection5/089.txt     \n","  inflating: Collection5/090.ann     \n","  inflating: Collection5/090.txt     \n","  inflating: Collection5/091.ann     \n","  inflating: Collection5/091.txt     \n","  inflating: Collection5/092.ann     \n","  inflating: Collection5/092.txt     \n","  inflating: Collection5/093.ann     \n","  inflating: Collection5/093.txt     \n","  inflating: Collection5/094.ann     \n","  inflating: Collection5/094.txt     \n","  inflating: Collection5/095.ann     \n","  inflating: Collection5/095.txt     \n","  inflating: Collection5/096.ann     \n","  inflating: Collection5/096.txt     \n","  inflating: Collection5/097.ann     \n","  inflating: Collection5/097.txt     \n","  inflating: Collection5/098.ann     \n","  inflating: Collection5/098.txt     \n","  inflating: Collection5/099.ann     \n","  inflating: Collection5/099.txt     \n","  inflating: Collection5/09_01_13.ann  \n","  inflating: Collection5/09_01_13.txt  \n","  inflating: Collection5/09_01_13a.ann  \n","  inflating: Collection5/09_01_13a.txt  \n","  inflating: Collection5/09_01_13c.ann  \n","  inflating: Collection5/09_01_13c.txt  \n","  inflating: Collection5/09_01_13d.ann  \n","  inflating: Collection5/09_01_13d.txt  \n","  inflating: Collection5/09_01_13e.ann  \n","  inflating: Collection5/09_01_13e.txt  \n","  inflating: Collection5/09_01_13h.ann  \n","  inflating: Collection5/09_01_13h.txt  \n","  inflating: Collection5/09_01_13i.ann  \n","  inflating: Collection5/09_01_13i.txt  \n","  inflating: Collection5/100.ann     \n","  inflating: Collection5/100.txt     \n","  inflating: Collection5/1000.ann    \n","  inflating: Collection5/1000.txt    \n","  inflating: Collection5/1001.ann    \n","  inflating: Collection5/1001.txt    \n","  inflating: Collection5/1002.ann    \n","  inflating: Collection5/1002.txt    \n","  inflating: Collection5/1003.ann    \n","  inflating: Collection5/1003.txt    \n","  inflating: Collection5/1004.ann    \n","  inflating: Collection5/1004.txt    \n","  inflating: Collection5/1005.ann    \n","  inflating: Collection5/1005.txt    \n","  inflating: Collection5/1006.ann    \n","  inflating: Collection5/1006.txt    \n","  inflating: Collection5/1007.ann    \n","  inflating: Collection5/1007.txt    \n","  inflating: Collection5/1008.ann    \n","  inflating: Collection5/1008.txt    \n","  inflating: Collection5/1009.ann    \n","  inflating: Collection5/1009.txt    \n","  inflating: Collection5/101.ann     \n","  inflating: Collection5/101.txt     \n","  inflating: Collection5/1010.ann    \n","  inflating: Collection5/1010.txt    \n","  inflating: Collection5/1011.ann    \n","  inflating: Collection5/1011.txt    \n","  inflating: Collection5/1012.ann    \n","  inflating: Collection5/1012.txt    \n","  inflating: Collection5/1013.ann    \n","  inflating: Collection5/1013.txt    \n","  inflating: Collection5/1014.ann    \n","  inflating: Collection5/1014.txt    \n","  inflating: Collection5/1015.ann    \n","  inflating: Collection5/1015.txt    \n","  inflating: Collection5/1016.ann    \n","  inflating: Collection5/1016.txt    \n","  inflating: Collection5/1017.ann    \n","  inflating: Collection5/1017.txt    \n","  inflating: Collection5/1018.ann    \n","  inflating: Collection5/1018.txt    \n","  inflating: Collection5/1019.ann    \n","  inflating: Collection5/1019.txt    \n","  inflating: Collection5/102.ann     \n","  inflating: Collection5/102.txt     \n","  inflating: Collection5/1020.ann    \n","  inflating: Collection5/1020.txt    \n","  inflating: Collection5/1021.ann    \n","  inflating: Collection5/1021.txt    \n","  inflating: Collection5/1022.ann    \n","  inflating: Collection5/1022.txt    \n","  inflating: Collection5/1023.ann    \n","  inflating: Collection5/1023.txt    \n","  inflating: Collection5/1024.ann    \n","  inflating: Collection5/1024.txt    \n","  inflating: Collection5/1025.ann    \n","  inflating: Collection5/1025.txt    \n","  inflating: Collection5/1026.ann    \n","  inflating: Collection5/1026.txt    \n","  inflating: Collection5/1027.ann    \n","  inflating: Collection5/1027.txt    \n","  inflating: Collection5/1028.ann    \n","  inflating: Collection5/1028.txt    \n","  inflating: Collection5/1029.ann    \n","  inflating: Collection5/1029.txt    \n","  inflating: Collection5/103.ann     \n","  inflating: Collection5/103.txt     \n","  inflating: Collection5/1030.ann    \n","  inflating: Collection5/1030.txt    \n","  inflating: Collection5/1031.ann    \n","  inflating: Collection5/1031.txt    \n","  inflating: Collection5/1032.ann    \n","  inflating: Collection5/1032.txt    \n","  inflating: Collection5/1033.ann    \n","  inflating: Collection5/1033.txt    \n","  inflating: Collection5/1034.ann    \n","  inflating: Collection5/1034.txt    \n","  inflating: Collection5/1035.ann    \n","  inflating: Collection5/1035.txt    \n","  inflating: Collection5/1036.ann    \n","  inflating: Collection5/1036.txt    \n","  inflating: Collection5/1037.ann    \n","  inflating: Collection5/1037.txt    \n","  inflating: Collection5/1038.ann    \n","  inflating: Collection5/1038.txt    \n","  inflating: Collection5/1039.ann    \n","  inflating: Collection5/1039.txt    \n","  inflating: Collection5/104.ann     \n","  inflating: Collection5/104.txt     \n","  inflating: Collection5/1040.ann    \n","  inflating: Collection5/1040.txt    \n","  inflating: Collection5/1041.ann    \n","  inflating: Collection5/1041.txt    \n","  inflating: Collection5/1042.ann    \n","  inflating: Collection5/1042.txt    \n","  inflating: Collection5/1043.ann    \n","  inflating: Collection5/1043.txt    \n","  inflating: Collection5/1044.ann    \n","  inflating: Collection5/1044.txt    \n","  inflating: Collection5/1045.ann    \n","  inflating: Collection5/1045.txt    \n","  inflating: Collection5/1046.ann    \n","  inflating: Collection5/1046.txt    \n","  inflating: Collection5/1047.ann    \n","  inflating: Collection5/1047.txt    \n","  inflating: Collection5/1048.ann    \n","  inflating: Collection5/1048.txt    \n","  inflating: Collection5/1049.ann    \n","  inflating: Collection5/1049.txt    \n","  inflating: Collection5/105.ann     \n","  inflating: Collection5/105.txt     \n","  inflating: Collection5/1050.ann    \n","  inflating: Collection5/1050.txt    \n","  inflating: Collection5/106.ann     \n","  inflating: Collection5/106.txt     \n","  inflating: Collection5/107.ann     \n","  inflating: Collection5/107.txt     \n","  inflating: Collection5/108.ann     \n","  inflating: Collection5/108.txt     \n","  inflating: Collection5/109.ann     \n","  inflating: Collection5/109.txt     \n","  inflating: Collection5/10_01_13a.ann  \n","  inflating: Collection5/10_01_13a.txt  \n","  inflating: Collection5/10_01_13d.ann  \n","  inflating: Collection5/10_01_13d.txt  \n","  inflating: Collection5/10_01_13i.ann  \n","  inflating: Collection5/10_01_13i.txt  \n","  inflating: Collection5/110.ann     \n","  inflating: Collection5/110.txt     \n","  inflating: Collection5/1100.ann    \n","  inflating: Collection5/1100.txt    \n","  inflating: Collection5/1101.ann    \n","  inflating: Collection5/1101.txt    \n","  inflating: Collection5/1102.ann    \n","  inflating: Collection5/1102.txt    \n","  inflating: Collection5/1103.ann    \n","  inflating: Collection5/1103.txt    \n","  inflating: Collection5/1104.ann    \n","  inflating: Collection5/1104.txt    \n","  inflating: Collection5/1105.ann    \n","  inflating: Collection5/1105.txt    \n","  inflating: Collection5/1106.ann    \n","  inflating: Collection5/1106.txt    \n","  inflating: Collection5/1107.ann    \n","  inflating: Collection5/1107.txt    \n","  inflating: Collection5/1108.ann    \n","  inflating: Collection5/1108.txt    \n","  inflating: Collection5/1109.ann    \n","  inflating: Collection5/1109.txt    \n","  inflating: Collection5/111.ann     \n","  inflating: Collection5/111.txt     \n","  inflating: Collection5/1110.ann    \n","  inflating: Collection5/1110.txt    \n","  inflating: Collection5/1111.ann    \n","  inflating: Collection5/1111.txt    \n","  inflating: Collection5/1112.ann    \n","  inflating: Collection5/1112.txt    \n","  inflating: Collection5/1113.ann    \n","  inflating: Collection5/1113.txt    \n","  inflating: Collection5/1114.ann    \n","  inflating: Collection5/1114.txt    \n","  inflating: Collection5/1115.ann    \n","  inflating: Collection5/1115.txt    \n","  inflating: Collection5/1116.ann    \n","  inflating: Collection5/1116.txt    \n","  inflating: Collection5/1117.ann    \n","  inflating: Collection5/1117.txt    \n","  inflating: Collection5/1118.ann    \n","  inflating: Collection5/1118.txt    \n","  inflating: Collection5/1119.ann    \n","  inflating: Collection5/1119.txt    \n","  inflating: Collection5/112.ann     \n","  inflating: Collection5/112.txt     \n","  inflating: Collection5/1120.ann    \n","  inflating: Collection5/1120.txt    \n","  inflating: Collection5/1121.ann    \n","  inflating: Collection5/1121.txt    \n","  inflating: Collection5/1122.ann    \n","  inflating: Collection5/1122.txt    \n","  inflating: Collection5/1123.ann    \n","  inflating: Collection5/1123.txt    \n","  inflating: Collection5/1124.ann    \n","  inflating: Collection5/1124.txt    \n","  inflating: Collection5/1125.ann    \n","  inflating: Collection5/1125.txt    \n","  inflating: Collection5/1126.ann    \n","  inflating: Collection5/1126.txt    \n","  inflating: Collection5/1127.ann    \n","  inflating: Collection5/1127.txt    \n","  inflating: Collection5/1128.ann    \n","  inflating: Collection5/1128.txt    \n","  inflating: Collection5/113.ann     \n","  inflating: Collection5/113.txt     \n","  inflating: Collection5/1130.ann    \n","  inflating: Collection5/1130.txt    \n","  inflating: Collection5/1131.ann    \n","  inflating: Collection5/1131.txt    \n","  inflating: Collection5/1132.ann    \n","  inflating: Collection5/1132.txt    \n","  inflating: Collection5/1133.ann    \n","  inflating: Collection5/1133.txt    \n","  inflating: Collection5/1134.ann    \n","  inflating: Collection5/1134.txt    \n","  inflating: Collection5/1135.ann    \n","  inflating: Collection5/1135.txt    \n","  inflating: Collection5/1136.ann    \n","  inflating: Collection5/1136.txt    \n","  inflating: Collection5/1137.ann    \n","  inflating: Collection5/1137.txt    \n","  inflating: Collection5/1138.ann    \n","  inflating: Collection5/1138.txt    \n","  inflating: Collection5/1139.ann    \n","  inflating: Collection5/1139.txt    \n","  inflating: Collection5/114.ann     \n","  inflating: Collection5/114.txt     \n","  inflating: Collection5/1140.ann    \n","  inflating: Collection5/1140.txt    \n","  inflating: Collection5/1141.ann    \n","  inflating: Collection5/1141.txt    \n","  inflating: Collection5/1142.ann    \n","  inflating: Collection5/1142.txt    \n","  inflating: Collection5/1143.ann    \n","  inflating: Collection5/1143.txt    \n","  inflating: Collection5/1144.ann    \n","  inflating: Collection5/1144.txt    \n","  inflating: Collection5/1145.ann    \n","  inflating: Collection5/1145.txt    \n","  inflating: Collection5/1146.ann    \n","  inflating: Collection5/1146.txt    \n","  inflating: Collection5/1147.ann    \n","  inflating: Collection5/1147.txt    \n","  inflating: Collection5/1148.ann    \n","  inflating: Collection5/1148.txt    \n","  inflating: Collection5/1149.ann    \n","  inflating: Collection5/1149.txt    \n","  inflating: Collection5/115.ann     \n","  inflating: Collection5/115.txt     \n","  inflating: Collection5/1150.ann    \n","  inflating: Collection5/1150.txt    \n","  inflating: Collection5/1151.ann    \n","  inflating: Collection5/1151.txt    \n","  inflating: Collection5/1152.ann    \n","  inflating: Collection5/1152.txt    \n","  inflating: Collection5/1153.ann    \n","  inflating: Collection5/1153.txt    \n","  inflating: Collection5/1154.ann    \n","  inflating: Collection5/1154.txt    \n","  inflating: Collection5/1155.ann    \n","  inflating: Collection5/1155.txt    \n","  inflating: Collection5/1156.ann    \n","  inflating: Collection5/1156.txt    \n","  inflating: Collection5/1157.ann    \n","  inflating: Collection5/1157.txt    \n","  inflating: Collection5/1158.ann    \n","  inflating: Collection5/1158.txt    \n","  inflating: Collection5/1159.ann    \n","  inflating: Collection5/1159.txt    \n","  inflating: Collection5/116.ann     \n","  inflating: Collection5/116.txt     \n","  inflating: Collection5/1160.ann    \n","  inflating: Collection5/1160.txt    \n","  inflating: Collection5/1161.ann    \n","  inflating: Collection5/1161.txt    \n","  inflating: Collection5/1162.ann    \n","  inflating: Collection5/1162.txt    \n","  inflating: Collection5/1163.ann    \n","  inflating: Collection5/1163.txt    \n","  inflating: Collection5/1164.ann    \n","  inflating: Collection5/1164.txt    \n","  inflating: Collection5/1165.ann    \n","  inflating: Collection5/1165.txt    \n","  inflating: Collection5/1166.ann    \n","  inflating: Collection5/1166.txt    \n","  inflating: Collection5/1167.ann    \n","  inflating: Collection5/1167.txt    \n","  inflating: Collection5/1168.ann    \n","  inflating: Collection5/1168.txt    \n","  inflating: Collection5/1169.ann    \n","  inflating: Collection5/1169.txt    \n","  inflating: Collection5/117.ann     \n","  inflating: Collection5/117.txt     \n","  inflating: Collection5/1170.ann    \n","  inflating: Collection5/1170.txt    \n","  inflating: Collection5/1171.ann    \n","  inflating: Collection5/1171.txt    \n","  inflating: Collection5/1172.ann    \n","  inflating: Collection5/1172.txt    \n","  inflating: Collection5/1173.ann    \n","  inflating: Collection5/1173.txt    \n","  inflating: Collection5/1174.ann    \n","  inflating: Collection5/1174.txt    \n","  inflating: Collection5/1175.ann    \n","  inflating: Collection5/1175.txt    \n","  inflating: Collection5/1176.ann    \n","  inflating: Collection5/1176.txt    \n","  inflating: Collection5/1177.ann    \n","  inflating: Collection5/1177.txt    \n","  inflating: Collection5/1178.ann    \n","  inflating: Collection5/1178.txt    \n","  inflating: Collection5/1179.ann    \n","  inflating: Collection5/1179.txt    \n","  inflating: Collection5/118.ann     \n","  inflating: Collection5/118.txt     \n","  inflating: Collection5/1180.ann    \n","  inflating: Collection5/1180.txt    \n","  inflating: Collection5/1181.ann    \n","  inflating: Collection5/1181.txt    \n","  inflating: Collection5/1182.ann    \n","  inflating: Collection5/1182.txt    \n","  inflating: Collection5/1183.ann    \n","  inflating: Collection5/1183.txt    \n","  inflating: Collection5/1184.ann    \n","  inflating: Collection5/1184.txt    \n","  inflating: Collection5/1185.ann    \n","  inflating: Collection5/1185.txt    \n","  inflating: Collection5/1186.ann    \n","  inflating: Collection5/1186.txt    \n","  inflating: Collection5/1187.ann    \n","  inflating: Collection5/1187.txt    \n","  inflating: Collection5/1188.ann    \n","  inflating: Collection5/1188.txt    \n","  inflating: Collection5/1189.ann    \n","  inflating: Collection5/1189.txt    \n","  inflating: Collection5/119.ann     \n","  inflating: Collection5/119.txt     \n","  inflating: Collection5/1190.ann    \n","  inflating: Collection5/1190.txt    \n","  inflating: Collection5/1191.ann    \n","  inflating: Collection5/1191.txt    \n","  inflating: Collection5/1192.ann    \n","  inflating: Collection5/1192.txt    \n","  inflating: Collection5/1193.ann    \n","  inflating: Collection5/1193.txt    \n","  inflating: Collection5/1194.ann    \n","  inflating: Collection5/1194.txt    \n","  inflating: Collection5/1195.ann    \n","  inflating: Collection5/1195.txt    \n","  inflating: Collection5/1196.ann    \n","  inflating: Collection5/1196.txt    \n","  inflating: Collection5/1197.ann    \n","  inflating: Collection5/1197.txt    \n","  inflating: Collection5/1198.ann    \n","  inflating: Collection5/1198.txt    \n","  inflating: Collection5/1199.ann    \n","  inflating: Collection5/1199.txt    \n","  inflating: Collection5/11_01_13b.ann  \n","  inflating: Collection5/11_01_13b.txt  \n","  inflating: Collection5/11_01_13e.ann  \n","  inflating: Collection5/11_01_13e.txt  \n","  inflating: Collection5/120.ann     \n","  inflating: Collection5/120.txt     \n","  inflating: Collection5/1200.ann    \n","  inflating: Collection5/1200.txt    \n","  inflating: Collection5/121.ann     \n","  inflating: Collection5/121.txt     \n","  inflating: Collection5/122.ann     \n","  inflating: Collection5/122.txt     \n","  inflating: Collection5/123.ann     \n","  inflating: Collection5/123.txt     \n","  inflating: Collection5/124.ann     \n","  inflating: Collection5/124.txt     \n","  inflating: Collection5/125.ann     \n","  inflating: Collection5/125.txt     \n","  inflating: Collection5/126.ann     \n","  inflating: Collection5/126.txt     \n","  inflating: Collection5/127.ann     \n","  inflating: Collection5/127.txt     \n","  inflating: Collection5/128.ann     \n","  inflating: Collection5/128.txt     \n","  inflating: Collection5/129.ann     \n","  inflating: Collection5/129.txt     \n","  inflating: Collection5/130.ann     \n","  inflating: Collection5/130.txt     \n","  inflating: Collection5/131.ann     \n","  inflating: Collection5/131.txt     \n","  inflating: Collection5/132.ann     \n","  inflating: Collection5/132.txt     \n","  inflating: Collection5/133.ann     \n","  inflating: Collection5/133.txt     \n","  inflating: Collection5/134.ann     \n","  inflating: Collection5/134.txt     \n","  inflating: Collection5/135.ann     \n","  inflating: Collection5/135.txt     \n","  inflating: Collection5/136.ann     \n","  inflating: Collection5/136.txt     \n","  inflating: Collection5/137.ann     \n","  inflating: Collection5/137.txt     \n","  inflating: Collection5/138.ann     \n","  inflating: Collection5/138.txt     \n","  inflating: Collection5/139.ann     \n","  inflating: Collection5/139.txt     \n","  inflating: Collection5/140.ann     \n","  inflating: Collection5/140.txt     \n","  inflating: Collection5/141.ann     \n","  inflating: Collection5/141.txt     \n","  inflating: Collection5/142.ann     \n","  inflating: Collection5/142.txt     \n","  inflating: Collection5/143.ann     \n","  inflating: Collection5/143.txt     \n","  inflating: Collection5/144.ann     \n","  inflating: Collection5/144.txt     \n","  inflating: Collection5/145.ann     \n","  inflating: Collection5/145.txt     \n","  inflating: Collection5/146.ann     \n","  inflating: Collection5/146.txt     \n","  inflating: Collection5/147.ann     \n","  inflating: Collection5/147.txt     \n","  inflating: Collection5/148.ann     \n","  inflating: Collection5/148.txt     \n","  inflating: Collection5/149.ann     \n","  inflating: Collection5/149.txt     \n","  inflating: Collection5/14_01_13c.ann  \n","  inflating: Collection5/14_01_13c.txt  \n","  inflating: Collection5/14_01_13g.ann  \n","  inflating: Collection5/14_01_13g.txt  \n","  inflating: Collection5/14_01_13i.ann  \n","  inflating: Collection5/14_01_13i.txt  \n","  inflating: Collection5/150.ann     \n","  inflating: Collection5/150.txt     \n","  inflating: Collection5/151.ann     \n","  inflating: Collection5/151.txt     \n","  inflating: Collection5/152.ann     \n","  inflating: Collection5/152.txt     \n","  inflating: Collection5/153.ann     \n","  inflating: Collection5/153.txt     \n","  inflating: Collection5/154.ann     \n","  inflating: Collection5/154.txt     \n","  inflating: Collection5/155.ann     \n","  inflating: Collection5/155.txt     \n","  inflating: Collection5/156.ann     \n","  inflating: Collection5/156.txt     \n","  inflating: Collection5/157.ann     \n","  inflating: Collection5/157.txt     \n","  inflating: Collection5/158.ann     \n","  inflating: Collection5/158.txt     \n","  inflating: Collection5/159.ann     \n","  inflating: Collection5/159.txt     \n","  inflating: Collection5/15_01_13a.ann  \n","  inflating: Collection5/15_01_13a.txt  \n","  inflating: Collection5/15_01_13b.ann  \n","  inflating: Collection5/15_01_13b.txt  \n","  inflating: Collection5/15_01_13e.ann  \n","  inflating: Collection5/15_01_13e.txt  \n","  inflating: Collection5/15_01_13f.ann  \n","  inflating: Collection5/15_01_13f.txt  \n","  inflating: Collection5/160.ann     \n","  inflating: Collection5/160.txt     \n","  inflating: Collection5/161.ann     \n","  inflating: Collection5/161.txt     \n","  inflating: Collection5/162.ann     \n","  inflating: Collection5/162.txt     \n","  inflating: Collection5/163.ann     \n","  inflating: Collection5/163.txt     \n","  inflating: Collection5/164.ann     \n","  inflating: Collection5/164.txt     \n","  inflating: Collection5/165.ann     \n","  inflating: Collection5/165.txt     \n","  inflating: Collection5/166.ann     \n","  inflating: Collection5/166.txt     \n","  inflating: Collection5/167.ann     \n","  inflating: Collection5/167.txt     \n","  inflating: Collection5/168.ann     \n","  inflating: Collection5/168.txt     \n","  inflating: Collection5/169.ann     \n","  inflating: Collection5/169.txt     \n","  inflating: Collection5/170.ann     \n","  inflating: Collection5/170.txt     \n","  inflating: Collection5/171.ann     \n","  inflating: Collection5/171.txt     \n","  inflating: Collection5/172.ann     \n","  inflating: Collection5/172.txt     \n","  inflating: Collection5/173.ann     \n","  inflating: Collection5/173.txt     \n","  inflating: Collection5/174.ann     \n","  inflating: Collection5/174.txt     \n","  inflating: Collection5/175.ann     \n","  inflating: Collection5/175.txt     \n","  inflating: Collection5/176.ann     \n","  inflating: Collection5/176.txt     \n","  inflating: Collection5/177.ann     \n","  inflating: Collection5/177.txt     \n","  inflating: Collection5/178.ann     \n","  inflating: Collection5/178.txt     \n","  inflating: Collection5/179.ann     \n","  inflating: Collection5/179.txt     \n","  inflating: Collection5/180.ann     \n","  inflating: Collection5/180.txt     \n","  inflating: Collection5/181.ann     \n","  inflating: Collection5/181.txt     \n","  inflating: Collection5/182.ann     \n","  inflating: Collection5/182.txt     \n","  inflating: Collection5/183.ann     \n","  inflating: Collection5/183.txt     \n","  inflating: Collection5/184.ann     \n","  inflating: Collection5/184.txt     \n","  inflating: Collection5/185.ann     \n","  inflating: Collection5/185.txt     \n","  inflating: Collection5/186.ann     \n","  inflating: Collection5/186.txt     \n","  inflating: Collection5/187.ann     \n","  inflating: Collection5/187.txt     \n","  inflating: Collection5/188.ann     \n","  inflating: Collection5/188.txt     \n","  inflating: Collection5/189.ann     \n","  inflating: Collection5/189.txt     \n","  inflating: Collection5/190.ann     \n","  inflating: Collection5/190.txt     \n","  inflating: Collection5/191.ann     \n","  inflating: Collection5/191.txt     \n","  inflating: Collection5/192.ann     \n","  inflating: Collection5/192.txt     \n","  inflating: Collection5/193.ann     \n","  inflating: Collection5/193.txt     \n","  inflating: Collection5/194.ann     \n","  inflating: Collection5/194.txt     \n","  inflating: Collection5/195.ann     \n","  inflating: Collection5/195.txt     \n","  inflating: Collection5/196.ann     \n","  inflating: Collection5/196.txt     \n","  inflating: Collection5/197.ann     \n","  inflating: Collection5/197.txt     \n","  inflating: Collection5/198.ann     \n","  inflating: Collection5/198.txt     \n","  inflating: Collection5/199.ann     \n","  inflating: Collection5/199.txt     \n","  inflating: Collection5/19_11_12d.ann  \n","  inflating: Collection5/19_11_12d.txt  \n","  inflating: Collection5/19_11_12h.ann  \n","  inflating: Collection5/19_11_12h.txt  \n","  inflating: Collection5/200.ann     \n","  inflating: Collection5/200.txt     \n","  inflating: Collection5/2001.ann    \n","  inflating: Collection5/2001.txt    \n","  inflating: Collection5/2002.ann    \n","  inflating: Collection5/2002.txt    \n","  inflating: Collection5/2003.ann    \n","  inflating: Collection5/2003.txt    \n","  inflating: Collection5/2004.ann    \n","  inflating: Collection5/2004.txt    \n","  inflating: Collection5/2005.ann    \n","  inflating: Collection5/2005.txt    \n","  inflating: Collection5/2006.ann    \n","  inflating: Collection5/2006.txt    \n","  inflating: Collection5/2007.ann    \n","  inflating: Collection5/2007.txt    \n","  inflating: Collection5/2008.ann    \n","  inflating: Collection5/2008.txt    \n","  inflating: Collection5/2009.ann    \n","  inflating: Collection5/2009.txt    \n","  inflating: Collection5/201.ann     \n","  inflating: Collection5/201.txt     \n","  inflating: Collection5/2010.ann    \n","  inflating: Collection5/2010.txt    \n","  inflating: Collection5/2011.ann    \n","  inflating: Collection5/2011.txt    \n","  inflating: Collection5/2012.ann    \n","  inflating: Collection5/2012.txt    \n","  inflating: Collection5/2013.ann    \n","  inflating: Collection5/2013.txt    \n","  inflating: Collection5/2014.ann    \n","  inflating: Collection5/2014.txt    \n","  inflating: Collection5/2015.ann    \n","  inflating: Collection5/2015.txt    \n","  inflating: Collection5/2016.ann    \n","  inflating: Collection5/2016.txt    \n","  inflating: Collection5/2017.ann    \n","  inflating: Collection5/2017.txt    \n","  inflating: Collection5/2018.ann    \n","  inflating: Collection5/2018.txt    \n","  inflating: Collection5/2019.ann    \n","  inflating: Collection5/2019.txt    \n","  inflating: Collection5/202.ann     \n","  inflating: Collection5/202.txt     \n","  inflating: Collection5/2020.ann    \n","  inflating: Collection5/2020.txt    \n","  inflating: Collection5/2021.ann    \n","  inflating: Collection5/2021.txt    \n","  inflating: Collection5/2022.ann    \n","  inflating: Collection5/2022.txt    \n","  inflating: Collection5/2023.ann    \n","  inflating: Collection5/2023.txt    \n","  inflating: Collection5/2024.ann    \n","  inflating: Collection5/2024.txt    \n","  inflating: Collection5/2025.ann    \n","  inflating: Collection5/2025.txt    \n","  inflating: Collection5/2026.ann    \n","  inflating: Collection5/2026.txt    \n","  inflating: Collection5/2027.ann    \n","  inflating: Collection5/2027.txt    \n","  inflating: Collection5/2028.ann    \n","  inflating: Collection5/2028.txt    \n","  inflating: Collection5/2029.ann    \n","  inflating: Collection5/2029.txt    \n","  inflating: Collection5/203.ann     \n","  inflating: Collection5/203.txt     \n","  inflating: Collection5/2030.ann    \n","  inflating: Collection5/2030.txt    \n","  inflating: Collection5/2031.ann    \n","  inflating: Collection5/2031.txt    \n","  inflating: Collection5/2032.ann    \n","  inflating: Collection5/2032.txt    \n","  inflating: Collection5/2034.ann    \n","  inflating: Collection5/2034.txt    \n","  inflating: Collection5/2035.ann    \n","  inflating: Collection5/2035.txt    \n","  inflating: Collection5/2036.ann    \n","  inflating: Collection5/2036.txt    \n","  inflating: Collection5/2037.ann    \n","  inflating: Collection5/2037.txt    \n","  inflating: Collection5/2038.ann    \n","  inflating: Collection5/2038.txt    \n","  inflating: Collection5/2039.ann    \n","  inflating: Collection5/2039.txt    \n","  inflating: Collection5/204.ann     \n","  inflating: Collection5/204.txt     \n","  inflating: Collection5/2040.ann    \n","  inflating: Collection5/2040.txt    \n","  inflating: Collection5/2041.ann    \n","  inflating: Collection5/2041.txt    \n","  inflating: Collection5/2042.ann    \n","  inflating: Collection5/2042.txt    \n","  inflating: Collection5/2043.ann    \n","  inflating: Collection5/2043.txt    \n","  inflating: Collection5/2044.ann    \n","  inflating: Collection5/2044.txt    \n","  inflating: Collection5/2045.ann    \n","  inflating: Collection5/2045.txt    \n","  inflating: Collection5/2046.ann    \n","  inflating: Collection5/2046.txt    \n","  inflating: Collection5/2047.ann    \n","  inflating: Collection5/2047.txt    \n","  inflating: Collection5/2048.ann    \n","  inflating: Collection5/2048.txt    \n","  inflating: Collection5/2049.ann    \n","  inflating: Collection5/2049.txt    \n","  inflating: Collection5/205.ann     \n","  inflating: Collection5/205.txt     \n","  inflating: Collection5/2050.ann    \n","  inflating: Collection5/2050.txt    \n","  inflating: Collection5/206.ann     \n","  inflating: Collection5/206.txt     \n","  inflating: Collection5/207.ann     \n","  inflating: Collection5/207.txt     \n","  inflating: Collection5/208.ann     \n","  inflating: Collection5/208.txt     \n","  inflating: Collection5/209.ann     \n","  inflating: Collection5/209.txt     \n","  inflating: Collection5/20_11_12a.ann  \n","  inflating: Collection5/20_11_12a.txt  \n","  inflating: Collection5/20_11_12b.ann  \n","  inflating: Collection5/20_11_12b.txt  \n","  inflating: Collection5/20_11_12c.ann  \n","  inflating: Collection5/20_11_12c.txt  \n","  inflating: Collection5/20_11_12d.ann  \n","  inflating: Collection5/20_11_12d.txt  \n","  inflating: Collection5/20_11_12i.ann  \n","  inflating: Collection5/20_11_12i.txt  \n","  inflating: Collection5/210.ann     \n","  inflating: Collection5/210.txt     \n","  inflating: Collection5/211.ann     \n","  inflating: Collection5/211.txt     \n","  inflating: Collection5/212.ann     \n","  inflating: Collection5/212.txt     \n","  inflating: Collection5/213.ann     \n","  inflating: Collection5/213.txt     \n","  inflating: Collection5/214.ann     \n","  inflating: Collection5/214.txt     \n","  inflating: Collection5/215.ann     \n","  inflating: Collection5/215.txt     \n","  inflating: Collection5/216.ann     \n","  inflating: Collection5/216.txt     \n","  inflating: Collection5/217.ann     \n","  inflating: Collection5/217.txt     \n","  inflating: Collection5/218.ann     \n","  inflating: Collection5/218.txt     \n","  inflating: Collection5/219.ann     \n","  inflating: Collection5/219.txt     \n","  inflating: Collection5/21_11_12c.ann  \n","  inflating: Collection5/21_11_12c.txt  \n","  inflating: Collection5/21_11_12h.ann  \n","  inflating: Collection5/21_11_12h.txt  \n","  inflating: Collection5/21_11_12i.ann  \n","  inflating: Collection5/21_11_12i.txt  \n","  inflating: Collection5/21_11_12j.ann  \n","  inflating: Collection5/21_11_12j.txt  \n","  inflating: Collection5/220.ann     \n","  inflating: Collection5/220.txt     \n","  inflating: Collection5/221.ann     \n","  inflating: Collection5/221.txt     \n","  inflating: Collection5/222.ann     \n","  inflating: Collection5/222.txt     \n","  inflating: Collection5/223.ann     \n","  inflating: Collection5/223.txt     \n","  inflating: Collection5/224.ann     \n","  inflating: Collection5/224.txt     \n","  inflating: Collection5/225.ann     \n","  inflating: Collection5/225.txt     \n","  inflating: Collection5/226.ann     \n","  inflating: Collection5/226.txt     \n","  inflating: Collection5/227.ann     \n","  inflating: Collection5/227.txt     \n","  inflating: Collection5/228.ann     \n","  inflating: Collection5/228.txt     \n","  inflating: Collection5/229.ann     \n","  inflating: Collection5/229.txt     \n","  inflating: Collection5/22_11_12a.ann  \n","  inflating: Collection5/22_11_12a.txt  \n","  inflating: Collection5/22_11_12c.ann  \n","  inflating: Collection5/22_11_12c.txt  \n","  inflating: Collection5/22_11_12d.ann  \n","  inflating: Collection5/22_11_12d.txt  \n","  inflating: Collection5/22_11_12g.ann  \n","  inflating: Collection5/22_11_12g.txt  \n","  inflating: Collection5/22_11_12h.ann  \n","  inflating: Collection5/22_11_12h.txt  \n","  inflating: Collection5/22_11_12i.ann  \n","  inflating: Collection5/22_11_12i.txt  \n","  inflating: Collection5/22_11_12j.ann  \n","  inflating: Collection5/22_11_12j.txt  \n","  inflating: Collection5/230.ann     \n","  inflating: Collection5/230.txt     \n","  inflating: Collection5/231.ann     \n","  inflating: Collection5/231.txt     \n","  inflating: Collection5/232.ann     \n","  inflating: Collection5/232.txt     \n","  inflating: Collection5/233.ann     \n","  inflating: Collection5/233.txt     \n","  inflating: Collection5/234.ann     \n","  inflating: Collection5/234.txt     \n","  inflating: Collection5/235.ann     \n","  inflating: Collection5/235.txt     \n","  inflating: Collection5/236.ann     \n","  inflating: Collection5/236.txt     \n","  inflating: Collection5/237.ann     \n","  inflating: Collection5/237.txt     \n","  inflating: Collection5/238.ann     \n","  inflating: Collection5/238.txt     \n","  inflating: Collection5/239.ann     \n","  inflating: Collection5/239.txt     \n","  inflating: Collection5/23_11_12a.ann  \n","  inflating: Collection5/23_11_12a.txt  \n","  inflating: Collection5/23_11_12b.ann  \n","  inflating: Collection5/23_11_12b.txt  \n","  inflating: Collection5/23_11_12c.ann  \n","  inflating: Collection5/23_11_12c.txt  \n","  inflating: Collection5/23_11_12d.ann  \n","  inflating: Collection5/23_11_12d.txt  \n","  inflating: Collection5/23_11_12e.ann  \n","  inflating: Collection5/23_11_12e.txt  \n","  inflating: Collection5/23_11_12f.ann  \n","  inflating: Collection5/23_11_12f.txt  \n","  inflating: Collection5/240.ann     \n","  inflating: Collection5/240.txt     \n","  inflating: Collection5/241.ann     \n","  inflating: Collection5/241.txt     \n","  inflating: Collection5/242.ann     \n","  inflating: Collection5/242.txt     \n","  inflating: Collection5/243.ann     \n","  inflating: Collection5/243.txt     \n","  inflating: Collection5/244.ann     \n","  inflating: Collection5/244.txt     \n","  inflating: Collection5/245.ann     \n","  inflating: Collection5/245.txt     \n","  inflating: Collection5/246.ann     \n","  inflating: Collection5/246.txt     \n","  inflating: Collection5/247.ann     \n","  inflating: Collection5/247.txt     \n","  inflating: Collection5/248.ann     \n","  inflating: Collection5/248.txt     \n","  inflating: Collection5/249.ann     \n","  inflating: Collection5/249.txt     \n","  inflating: Collection5/250.ann     \n","  inflating: Collection5/250.txt     \n","  inflating: Collection5/251.ann     \n","  inflating: Collection5/251.txt     \n","  inflating: Collection5/252.ann     \n","  inflating: Collection5/252.txt     \n","  inflating: Collection5/253.ann     \n","  inflating: Collection5/253.txt     \n","  inflating: Collection5/254.ann     \n","  inflating: Collection5/254.txt     \n","  inflating: Collection5/255.ann     \n","  inflating: Collection5/255.txt     \n","  inflating: Collection5/256.ann     \n","  inflating: Collection5/256.txt     \n","  inflating: Collection5/257.ann     \n","  inflating: Collection5/257.txt     \n","  inflating: Collection5/258.ann     \n","  inflating: Collection5/258.txt     \n","  inflating: Collection5/259.ann     \n","  inflating: Collection5/259.txt     \n","  inflating: Collection5/25_12_12a.ann  \n","  inflating: Collection5/25_12_12a.txt  \n","  inflating: Collection5/25_12_12c.ann  \n","  inflating: Collection5/25_12_12c.txt  \n","  inflating: Collection5/25_12_12d.ann  \n","  inflating: Collection5/25_12_12d.txt  \n","  inflating: Collection5/25_12_12e.ann  \n","  inflating: Collection5/25_12_12e.txt  \n","  inflating: Collection5/260.ann     \n","  inflating: Collection5/260.txt     \n","  inflating: Collection5/261.ann     \n","  inflating: Collection5/261.txt     \n","  inflating: Collection5/262.ann     \n","  inflating: Collection5/262.txt     \n","  inflating: Collection5/263.ann     \n","  inflating: Collection5/263.txt     \n","  inflating: Collection5/264.ann     \n","  inflating: Collection5/264.txt     \n","  inflating: Collection5/265.ann     \n","  inflating: Collection5/265.txt     \n","  inflating: Collection5/266.ann     \n","  inflating: Collection5/266.txt     \n","  inflating: Collection5/267.ann     \n","  inflating: Collection5/267.txt     \n","  inflating: Collection5/268.ann     \n","  inflating: Collection5/268.txt     \n","  inflating: Collection5/269.ann     \n","  inflating: Collection5/269.txt     \n","  inflating: Collection5/26_11_12b.ann  \n","  inflating: Collection5/26_11_12b.txt  \n","  inflating: Collection5/26_11_12c.ann  \n","  inflating: Collection5/26_11_12c.txt  \n","  inflating: Collection5/26_11_12e.ann  \n","  inflating: Collection5/26_11_12e.txt  \n","  inflating: Collection5/26_11_12f.ann  \n","  inflating: Collection5/26_11_12f.txt  \n","  inflating: Collection5/270.ann     \n","  inflating: Collection5/270.txt     \n","  inflating: Collection5/271.ann     \n","  inflating: Collection5/271.txt     \n","  inflating: Collection5/272.ann     \n","  inflating: Collection5/272.txt     \n","  inflating: Collection5/273.ann     \n","  inflating: Collection5/273.txt     \n","  inflating: Collection5/274.ann     \n","  inflating: Collection5/274.txt     \n","  inflating: Collection5/275.ann     \n","  inflating: Collection5/275.txt     \n","  inflating: Collection5/276.ann     \n","  inflating: Collection5/276.txt     \n","  inflating: Collection5/277.ann     \n","  inflating: Collection5/277.txt     \n","  inflating: Collection5/278.ann     \n","  inflating: Collection5/278.txt     \n","  inflating: Collection5/279.ann     \n","  inflating: Collection5/279.txt     \n","  inflating: Collection5/27_11_12a.ann  \n","  inflating: Collection5/27_11_12a.txt  \n","  inflating: Collection5/27_11_12c.ann  \n","  inflating: Collection5/27_11_12c.txt  \n","  inflating: Collection5/27_11_12d.ann  \n","  inflating: Collection5/27_11_12d.txt  \n","  inflating: Collection5/27_11_12e.ann  \n","  inflating: Collection5/27_11_12e.txt  \n","  inflating: Collection5/27_11_12j.ann  \n","  inflating: Collection5/27_11_12j.txt  \n","  inflating: Collection5/280.ann     \n","  inflating: Collection5/280.txt     \n","  inflating: Collection5/281.ann     \n","  inflating: Collection5/281.txt     \n","  inflating: Collection5/282.ann     \n","  inflating: Collection5/282.txt     \n","  inflating: Collection5/283.ann     \n","  inflating: Collection5/283.txt     \n","  inflating: Collection5/284.ann     \n","  inflating: Collection5/284.txt     \n","  inflating: Collection5/285.ann     \n","  inflating: Collection5/285.txt     \n","  inflating: Collection5/286.ann     \n","  inflating: Collection5/286.txt     \n","  inflating: Collection5/287.ann     \n","  inflating: Collection5/287.txt     \n","  inflating: Collection5/288.ann     \n","  inflating: Collection5/288.txt     \n","  inflating: Collection5/289.ann     \n","  inflating: Collection5/289.txt     \n","  inflating: Collection5/28_11_12a.ann  \n","  inflating: Collection5/28_11_12a.txt  \n","  inflating: Collection5/28_11_12f.ann  \n","  inflating: Collection5/28_11_12f.txt  \n","  inflating: Collection5/28_11_12g.ann  \n","  inflating: Collection5/28_11_12g.txt  \n","  inflating: Collection5/28_11_12h.ann  \n","  inflating: Collection5/28_11_12h.txt  \n","  inflating: Collection5/28_11_12i.ann  \n","  inflating: Collection5/28_11_12i.txt  \n","  inflating: Collection5/28_11_12j.ann  \n","  inflating: Collection5/28_11_12j.txt  \n","  inflating: Collection5/290.ann     \n","  inflating: Collection5/290.txt     \n","  inflating: Collection5/291.ann     \n","  inflating: Collection5/291.txt     \n","  inflating: Collection5/292.ann     \n","  inflating: Collection5/292.txt     \n","  inflating: Collection5/293.ann     \n","  inflating: Collection5/293.txt     \n","  inflating: Collection5/294.ann     \n","  inflating: Collection5/294.txt     \n","  inflating: Collection5/295.ann     \n","  inflating: Collection5/295.txt     \n","  inflating: Collection5/296.ann     \n","  inflating: Collection5/296.txt     \n","  inflating: Collection5/297.ann     \n","  inflating: Collection5/297.txt     \n","  inflating: Collection5/298.ann     \n","  inflating: Collection5/298.txt     \n","  inflating: Collection5/299.ann     \n","  inflating: Collection5/299.txt     \n","  inflating: Collection5/29_11_12a.ann  \n","  inflating: Collection5/29_11_12a.txt  \n","  inflating: Collection5/29_11_12b.ann  \n","  inflating: Collection5/29_11_12b.txt  \n","  inflating: Collection5/300.ann     \n","  inflating: Collection5/300.txt     \n","  inflating: Collection5/301.ann     \n","  inflating: Collection5/301.txt     \n","  inflating: Collection5/302.ann     \n","  inflating: Collection5/302.txt     \n","  inflating: Collection5/303.ann     \n","  inflating: Collection5/303.txt     \n","  inflating: Collection5/304.ann     \n","  inflating: Collection5/304.txt     \n","  inflating: Collection5/305.ann     \n","  inflating: Collection5/305.txt     \n","  inflating: Collection5/306.ann     \n","  inflating: Collection5/306.txt     \n","  inflating: Collection5/307.ann     \n","  inflating: Collection5/307.txt     \n","  inflating: Collection5/308.ann     \n","  inflating: Collection5/308.txt     \n","  inflating: Collection5/309.ann     \n","  inflating: Collection5/309.txt     \n","  inflating: Collection5/30_11_12b.ann  \n","  inflating: Collection5/30_11_12b.txt  \n","  inflating: Collection5/30_11_12h.ann  \n","  inflating: Collection5/30_11_12h.txt  \n","  inflating: Collection5/30_11_12i.ann  \n","  inflating: Collection5/30_11_12i.txt  \n","  inflating: Collection5/310.ann     \n","  inflating: Collection5/310.txt     \n","  inflating: Collection5/311.ann     \n","  inflating: Collection5/311.txt     \n","  inflating: Collection5/312.ann     \n","  inflating: Collection5/312.txt     \n","  inflating: Collection5/313.ann     \n","  inflating: Collection5/313.txt     \n","  inflating: Collection5/314.ann     \n","  inflating: Collection5/314.txt     \n","  inflating: Collection5/315.ann     \n","  inflating: Collection5/315.txt     \n","  inflating: Collection5/316.ann     \n","  inflating: Collection5/316.txt     \n","  inflating: Collection5/317.ann     \n","  inflating: Collection5/317.txt     \n","  inflating: Collection5/318.ann     \n","  inflating: Collection5/318.txt     \n","  inflating: Collection5/319.ann     \n","  inflating: Collection5/319.txt     \n","  inflating: Collection5/320.ann     \n","  inflating: Collection5/320.txt     \n","  inflating: Collection5/321.ann     \n","  inflating: Collection5/321.txt     \n","  inflating: Collection5/322.ann     \n","  inflating: Collection5/322.txt     \n","  inflating: Collection5/323.ann     \n","  inflating: Collection5/323.txt     \n","  inflating: Collection5/324.ann     \n","  inflating: Collection5/324.txt     \n","  inflating: Collection5/325.ann     \n","  inflating: Collection5/325.txt     \n","  inflating: Collection5/326.ann     \n","  inflating: Collection5/326.txt     \n","  inflating: Collection5/327.ann     \n","  inflating: Collection5/327.txt     \n","  inflating: Collection5/328.ann     \n","  inflating: Collection5/328.txt     \n","  inflating: Collection5/329.ann     \n","  inflating: Collection5/329.txt     \n","  inflating: Collection5/330.ann     \n","  inflating: Collection5/330.txt     \n","  inflating: Collection5/331.ann     \n","  inflating: Collection5/331.txt     \n","  inflating: Collection5/332.ann     \n","  inflating: Collection5/332.txt     \n","  inflating: Collection5/333.ann     \n","  inflating: Collection5/333.txt     \n","  inflating: Collection5/334.ann     \n","  inflating: Collection5/334.txt     \n","  inflating: Collection5/335.ann     \n","  inflating: Collection5/335.txt     \n","  inflating: Collection5/336.ann     \n","  inflating: Collection5/336.txt     \n","  inflating: Collection5/337.ann     \n","  inflating: Collection5/337.txt     \n","  inflating: Collection5/338.ann     \n","  inflating: Collection5/338.txt     \n","  inflating: Collection5/339.ann     \n","  inflating: Collection5/339.txt     \n","  inflating: Collection5/340.ann     \n","  inflating: Collection5/340.txt     \n","  inflating: Collection5/341.ann     \n","  inflating: Collection5/341.txt     \n","  inflating: Collection5/342.ann     \n","  inflating: Collection5/342.txt     \n","  inflating: Collection5/343.ann     \n","  inflating: Collection5/343.txt     \n","  inflating: Collection5/344.ann     \n","  inflating: Collection5/344.txt     \n","  inflating: Collection5/345.ann     \n","  inflating: Collection5/345.txt     \n","  inflating: Collection5/346.ann     \n","  inflating: Collection5/346.txt     \n","  inflating: Collection5/347.ann     \n","  inflating: Collection5/347.txt     \n","  inflating: Collection5/348.ann     \n","  inflating: Collection5/348.txt     \n","  inflating: Collection5/349.ann     \n","  inflating: Collection5/349.txt     \n","  inflating: Collection5/350.ann     \n","  inflating: Collection5/350.txt     \n","  inflating: Collection5/351.ann     \n","  inflating: Collection5/351.txt     \n","  inflating: Collection5/352.ann     \n","  inflating: Collection5/352.txt     \n","  inflating: Collection5/353.ann     \n","  inflating: Collection5/353.txt     \n","  inflating: Collection5/354.ann     \n","  inflating: Collection5/354.txt     \n","  inflating: Collection5/355.ann     \n","  inflating: Collection5/355.txt     \n","  inflating: Collection5/356.ann     \n","  inflating: Collection5/356.txt     \n","  inflating: Collection5/357.ann     \n","  inflating: Collection5/357.txt     \n","  inflating: Collection5/358.ann     \n","  inflating: Collection5/358.txt     \n","  inflating: Collection5/359.ann     \n","  inflating: Collection5/359.txt     \n","  inflating: Collection5/360.ann     \n","  inflating: Collection5/360.txt     \n","  inflating: Collection5/361.ann     \n","  inflating: Collection5/361.txt     \n","  inflating: Collection5/362.ann     \n","  inflating: Collection5/362.txt     \n","  inflating: Collection5/363.ann     \n","  inflating: Collection5/363.txt     \n","  inflating: Collection5/364.ann     \n","  inflating: Collection5/364.txt     \n","  inflating: Collection5/365.ann     \n","  inflating: Collection5/365.txt     \n","  inflating: Collection5/366.ann     \n","  inflating: Collection5/366.txt     \n","  inflating: Collection5/367.ann     \n","  inflating: Collection5/367.txt     \n","  inflating: Collection5/368.ann     \n","  inflating: Collection5/368.txt     \n","  inflating: Collection5/369.ann     \n","  inflating: Collection5/369.txt     \n","  inflating: Collection5/370.ann     \n","  inflating: Collection5/370.txt     \n","  inflating: Collection5/371.ann     \n","  inflating: Collection5/371.txt     \n","  inflating: Collection5/372.ann     \n","  inflating: Collection5/372.txt     \n","  inflating: Collection5/373.ann     \n","  inflating: Collection5/373.txt     \n","  inflating: Collection5/374.ann     \n","  inflating: Collection5/374.txt     \n","  inflating: Collection5/375.ann     \n","  inflating: Collection5/375.txt     \n","  inflating: Collection5/376.ann     \n","  inflating: Collection5/376.txt     \n","  inflating: Collection5/377.ann     \n","  inflating: Collection5/377.txt     \n","  inflating: Collection5/378.ann     \n","  inflating: Collection5/378.txt     \n","  inflating: Collection5/379.ann     \n","  inflating: Collection5/379.txt     \n","  inflating: Collection5/380.ann     \n","  inflating: Collection5/380.txt     \n","  inflating: Collection5/381.ann     \n","  inflating: Collection5/381.txt     \n","  inflating: Collection5/382.ann     \n","  inflating: Collection5/382.txt     \n","  inflating: Collection5/383.ann     \n","  inflating: Collection5/383.txt     \n","  inflating: Collection5/384.ann     \n","  inflating: Collection5/384.txt     \n","  inflating: Collection5/385.ann     \n","  inflating: Collection5/385.txt     \n","  inflating: Collection5/386.ann     \n","  inflating: Collection5/386.txt     \n","  inflating: Collection5/387.ann     \n","  inflating: Collection5/387.txt     \n","  inflating: Collection5/388.ann     \n","  inflating: Collection5/388.txt     \n","  inflating: Collection5/389.ann     \n","  inflating: Collection5/389.txt     \n","  inflating: Collection5/390.ann     \n","  inflating: Collection5/390.txt     \n","  inflating: Collection5/391.ann     \n","  inflating: Collection5/391.txt     \n","  inflating: Collection5/392.ann     \n","  inflating: Collection5/392.txt     \n","  inflating: Collection5/393.ann     \n","  inflating: Collection5/393.txt     \n","  inflating: Collection5/394.ann     \n","  inflating: Collection5/394.txt     \n","  inflating: Collection5/395.ann     \n","  inflating: Collection5/395.txt     \n","  inflating: Collection5/396.ann     \n","  inflating: Collection5/396.txt     \n","  inflating: Collection5/397.ann     \n","  inflating: Collection5/397.txt     \n","  inflating: Collection5/398.ann     \n","  inflating: Collection5/398.txt     \n","  inflating: Collection5/399.ann     \n","  inflating: Collection5/399.txt     \n","  inflating: Collection5/400.ann     \n","  inflating: Collection5/400.txt     \n","  inflating: Collection5/401.ann     \n","  inflating: Collection5/401.txt     \n","  inflating: Collection5/402.ann     \n","  inflating: Collection5/402.txt     \n","  inflating: Collection5/403.ann     \n","  inflating: Collection5/403.txt     \n","  inflating: Collection5/404.ann     \n","  inflating: Collection5/404.txt     \n","  inflating: Collection5/405.ann     \n","  inflating: Collection5/405.txt     \n","  inflating: Collection5/406.ann     \n","  inflating: Collection5/406.txt     \n","  inflating: Collection5/407.ann     \n","  inflating: Collection5/407.txt     \n","  inflating: Collection5/408.ann     \n","  inflating: Collection5/408.txt     \n","  inflating: Collection5/409.ann     \n","  inflating: Collection5/409.txt     \n","  inflating: Collection5/410.ann     \n","  inflating: Collection5/410.txt     \n","  inflating: Collection5/411.ann     \n","  inflating: Collection5/411.txt     \n","  inflating: Collection5/412.ann     \n","  inflating: Collection5/412.txt     \n","  inflating: Collection5/413.ann     \n","  inflating: Collection5/413.txt     \n","  inflating: Collection5/414.ann     \n","  inflating: Collection5/414.txt     \n","  inflating: Collection5/415.ann     \n","  inflating: Collection5/415.txt     \n","  inflating: Collection5/416.ann     \n","  inflating: Collection5/416.txt     \n","  inflating: Collection5/417.ann     \n","  inflating: Collection5/417.txt     \n","  inflating: Collection5/418.ann     \n","  inflating: Collection5/418.txt     \n","  inflating: Collection5/419.ann     \n","  inflating: Collection5/419.txt     \n","  inflating: Collection5/420.ann     \n","  inflating: Collection5/420.txt     \n","  inflating: Collection5/421.ann     \n","  inflating: Collection5/421.txt     \n","  inflating: Collection5/422.ann     \n","  inflating: Collection5/422.txt     \n","  inflating: Collection5/423.ann     \n","  inflating: Collection5/423.txt     \n","  inflating: Collection5/424.ann     \n","  inflating: Collection5/424.txt     \n","  inflating: Collection5/425.ann     \n","  inflating: Collection5/425.txt     \n","  inflating: Collection5/426.ann     \n","  inflating: Collection5/426.txt     \n","  inflating: Collection5/427.ann     \n","  inflating: Collection5/427.txt     \n","  inflating: Collection5/428.ann     \n","  inflating: Collection5/428.txt     \n","  inflating: Collection5/429.ann     \n","  inflating: Collection5/429.txt     \n","  inflating: Collection5/430.ann     \n","  inflating: Collection5/430.txt     \n","  inflating: Collection5/431.ann     \n","  inflating: Collection5/431.txt     \n","  inflating: Collection5/432.ann     \n","  inflating: Collection5/432.txt     \n","  inflating: Collection5/433.ann     \n","  inflating: Collection5/433.txt     \n","  inflating: Collection5/434.ann     \n","  inflating: Collection5/434.txt     \n","  inflating: Collection5/435.ann     \n","  inflating: Collection5/435.txt     \n","  inflating: Collection5/436.ann     \n","  inflating: Collection5/436.txt     \n","  inflating: Collection5/437.ann     \n","  inflating: Collection5/437.txt     \n","  inflating: Collection5/438.ann     \n","  inflating: Collection5/438.txt     \n","  inflating: Collection5/439.ann     \n","  inflating: Collection5/439.txt     \n","  inflating: Collection5/440.ann     \n","  inflating: Collection5/440.txt     \n","  inflating: Collection5/441.ann     \n","  inflating: Collection5/441.txt     \n","  inflating: Collection5/442.ann     \n","  inflating: Collection5/442.txt     \n","  inflating: Collection5/443.ann     \n","  inflating: Collection5/443.txt     \n","  inflating: Collection5/444.ann     \n","  inflating: Collection5/444.txt     \n","  inflating: Collection5/445.ann     \n","  inflating: Collection5/445.txt     \n","  inflating: Collection5/446.ann     \n","  inflating: Collection5/446.txt     \n","  inflating: Collection5/447.ann     \n","  inflating: Collection5/447.txt     \n","  inflating: Collection5/448.ann     \n","  inflating: Collection5/448.txt     \n","  inflating: Collection5/449.ann     \n","  inflating: Collection5/449.txt     \n","  inflating: Collection5/450.ann     \n","  inflating: Collection5/450.txt     \n","  inflating: Collection5/451.ann     \n","  inflating: Collection5/451.txt     \n","  inflating: Collection5/452.ann     \n","  inflating: Collection5/452.txt     \n","  inflating: Collection5/453.ann     \n","  inflating: Collection5/453.txt     \n","  inflating: Collection5/454.ann     \n","  inflating: Collection5/454.txt     \n","  inflating: Collection5/455.ann     \n","  inflating: Collection5/455.txt     \n","  inflating: Collection5/457.ann     \n","  inflating: Collection5/457.txt     \n","  inflating: Collection5/458.ann     \n","  inflating: Collection5/458.txt     \n","  inflating: Collection5/459.ann     \n","  inflating: Collection5/459.txt     \n","  inflating: Collection5/460.ann     \n","  inflating: Collection5/460.txt     \n","  inflating: Collection5/461.ann     \n","  inflating: Collection5/461.txt     \n","  inflating: Collection5/462.ann     \n","  inflating: Collection5/462.txt     \n","  inflating: Collection5/463.ann     \n","  inflating: Collection5/463.txt     \n","  inflating: Collection5/464.ann     \n","  inflating: Collection5/464.txt     \n","  inflating: Collection5/465.ann     \n","  inflating: Collection5/465.txt     \n","  inflating: Collection5/466.ann     \n","  inflating: Collection5/466.txt     \n","  inflating: Collection5/467.ann     \n","  inflating: Collection5/467.txt     \n","  inflating: Collection5/468.ann     \n","  inflating: Collection5/468.txt     \n","  inflating: Collection5/469.ann     \n","  inflating: Collection5/469.txt     \n","  inflating: Collection5/470.ann     \n","  inflating: Collection5/470.txt     \n","  inflating: Collection5/471.ann     \n","  inflating: Collection5/471.txt     \n","  inflating: Collection5/472.ann     \n","  inflating: Collection5/472.txt     \n","  inflating: Collection5/473.ann     \n","  inflating: Collection5/473.txt     \n","  inflating: Collection5/474.ann     \n","  inflating: Collection5/474.txt     \n","  inflating: Collection5/475.ann     \n","  inflating: Collection5/475.txt     \n","  inflating: Collection5/476.ann     \n","  inflating: Collection5/476.txt     \n","  inflating: Collection5/477.ann     \n","  inflating: Collection5/477.txt     \n","  inflating: Collection5/478.ann     \n","  inflating: Collection5/478.txt     \n","  inflating: Collection5/479.ann     \n","  inflating: Collection5/479.txt     \n","  inflating: Collection5/480.ann     \n","  inflating: Collection5/480.txt     \n","  inflating: Collection5/481.ann     \n","  inflating: Collection5/481.txt     \n","  inflating: Collection5/482.ann     \n","  inflating: Collection5/482.txt     \n","  inflating: Collection5/483.ann     \n","  inflating: Collection5/483.txt     \n","  inflating: Collection5/484.ann     \n","  inflating: Collection5/484.txt     \n","  inflating: Collection5/485.ann     \n","  inflating: Collection5/485.txt     \n","  inflating: Collection5/486.ann     \n","  inflating: Collection5/486.txt     \n","  inflating: Collection5/487.ann     \n","  inflating: Collection5/487.txt     \n","  inflating: Collection5/488.ann     \n","  inflating: Collection5/488.txt     \n","  inflating: Collection5/489.ann     \n","  inflating: Collection5/489.txt     \n","  inflating: Collection5/490.ann     \n","  inflating: Collection5/490.txt     \n","  inflating: Collection5/491.ann     \n","  inflating: Collection5/491.txt     \n","  inflating: Collection5/492.ann     \n","  inflating: Collection5/492.txt     \n","  inflating: Collection5/493.ann     \n","  inflating: Collection5/493.txt     \n","  inflating: Collection5/494.ann     \n","  inflating: Collection5/494.txt     \n","  inflating: Collection5/495.ann     \n","  inflating: Collection5/495.txt     \n","  inflating: Collection5/496.ann     \n","  inflating: Collection5/496.txt     \n","  inflating: Collection5/497.ann     \n","  inflating: Collection5/497.txt     \n","  inflating: Collection5/498.ann     \n","  inflating: Collection5/498.txt     \n","  inflating: Collection5/499.ann     \n","  inflating: Collection5/499.txt     \n","  inflating: Collection5/500.ann     \n","  inflating: Collection5/500.txt     \n","  inflating: Collection5/501.ann     \n","  inflating: Collection5/501.txt     \n","  inflating: Collection5/502.ann     \n","  inflating: Collection5/502.txt     \n","  inflating: Collection5/503.ann     \n","  inflating: Collection5/503.txt     \n","  inflating: Collection5/504.ann     \n","  inflating: Collection5/504.txt     \n","  inflating: Collection5/505.ann     \n","  inflating: Collection5/505.txt     \n","  inflating: Collection5/506.ann     \n","  inflating: Collection5/506.txt     \n","  inflating: Collection5/507.ann     \n","  inflating: Collection5/507.txt     \n","  inflating: Collection5/508.ann     \n","  inflating: Collection5/508.txt     \n","  inflating: Collection5/509.ann     \n","  inflating: Collection5/509.txt     \n","  inflating: Collection5/510.ann     \n","  inflating: Collection5/510.txt     \n","  inflating: Collection5/511.ann     \n","  inflating: Collection5/511.txt     \n","  inflating: Collection5/512.ann     \n","  inflating: Collection5/512.txt     \n","  inflating: Collection5/513.ann     \n","  inflating: Collection5/513.txt     \n","  inflating: Collection5/514.ann     \n","  inflating: Collection5/514.txt     \n","  inflating: Collection5/515.ann     \n","  inflating: Collection5/515.txt     \n","  inflating: Collection5/516.ann     \n","  inflating: Collection5/516.txt     \n","  inflating: Collection5/517.ann     \n","  inflating: Collection5/517.txt     \n","  inflating: Collection5/518.ann     \n","  inflating: Collection5/518.txt     \n","  inflating: Collection5/519.ann     \n","  inflating: Collection5/519.txt     \n","  inflating: Collection5/520.ann     \n","  inflating: Collection5/520.txt     \n","  inflating: Collection5/521.ann     \n","  inflating: Collection5/521.txt     \n","  inflating: Collection5/522.ann     \n","  inflating: Collection5/522.txt     \n","  inflating: Collection5/523.ann     \n","  inflating: Collection5/523.txt     \n","  inflating: Collection5/524.ann     \n","  inflating: Collection5/524.txt     \n","  inflating: Collection5/525.ann     \n","  inflating: Collection5/525.txt     \n","  inflating: Collection5/526.ann     \n","  inflating: Collection5/526.txt     \n","  inflating: Collection5/527.ann     \n","  inflating: Collection5/527.txt     \n","  inflating: Collection5/528.ann     \n","  inflating: Collection5/528.txt     \n","  inflating: Collection5/529.ann     \n","  inflating: Collection5/529.txt     \n","  inflating: Collection5/530.ann     \n","  inflating: Collection5/530.txt     \n","  inflating: Collection5/531.ann     \n","  inflating: Collection5/531.txt     \n","  inflating: Collection5/532.ann     \n","  inflating: Collection5/532.txt     \n","  inflating: Collection5/533 (!).ann  \n","  inflating: Collection5/533 (!).txt  \n","  inflating: Collection5/534.ann     \n","  inflating: Collection5/534.txt     \n","  inflating: Collection5/535.ann     \n","  inflating: Collection5/535.txt     \n","  inflating: Collection5/536.ann     \n","  inflating: Collection5/536.txt     \n","  inflating: Collection5/537.ann     \n","  inflating: Collection5/537.txt     \n","  inflating: Collection5/538.ann     \n","  inflating: Collection5/538.txt     \n","  inflating: Collection5/539.ann     \n","  inflating: Collection5/539.txt     \n","  inflating: Collection5/540.ann     \n","  inflating: Collection5/540.txt     \n","  inflating: Collection5/541.ann     \n","  inflating: Collection5/541.txt     \n","  inflating: Collection5/542.ann     \n","  inflating: Collection5/542.txt     \n","  inflating: Collection5/543.ann     \n","  inflating: Collection5/543.txt     \n","  inflating: Collection5/544.ann     \n","  inflating: Collection5/544.txt     \n","  inflating: Collection5/545.ann     \n","  inflating: Collection5/545.txt     \n","  inflating: Collection5/546.ann     \n","  inflating: Collection5/546.txt     \n","  inflating: Collection5/547.ann     \n","  inflating: Collection5/547.txt     \n","  inflating: Collection5/548.ann     \n","  inflating: Collection5/548.txt     \n","  inflating: Collection5/549.ann     \n","  inflating: Collection5/549.txt     \n","  inflating: Collection5/550.ann     \n","  inflating: Collection5/550.txt     \n","  inflating: Collection5/551.ann     \n","  inflating: Collection5/551.txt     \n","  inflating: Collection5/552.ann     \n","  inflating: Collection5/552.txt     \n","  inflating: Collection5/553.ann     \n","  inflating: Collection5/553.txt     \n","  inflating: Collection5/554.ann     \n","  inflating: Collection5/554.txt     \n","  inflating: Collection5/555 (!).ann  \n","  inflating: Collection5/555 (!).txt  \n","  inflating: Collection5/556.ann     \n","  inflating: Collection5/556.txt     \n","  inflating: Collection5/557.ann     \n","  inflating: Collection5/557.txt     \n","  inflating: Collection5/558.ann     \n","  inflating: Collection5/558.txt     \n","  inflating: Collection5/559.ann     \n","  inflating: Collection5/559.txt     \n","  inflating: Collection5/560.ann     \n","  inflating: Collection5/560.txt     \n","  inflating: Collection5/561.ann     \n","  inflating: Collection5/561.txt     \n","  inflating: Collection5/562.ann     \n","  inflating: Collection5/562.txt     \n","  inflating: Collection5/563.ann     \n","  inflating: Collection5/563.txt     \n","  inflating: Collection5/564.ann     \n","  inflating: Collection5/564.txt     \n","  inflating: Collection5/565.ann     \n","  inflating: Collection5/565.txt     \n","  inflating: Collection5/567.ann     \n","  inflating: Collection5/567.txt     \n","  inflating: Collection5/568.ann     \n","  inflating: Collection5/568.txt     \n","  inflating: Collection5/569.ann     \n","  inflating: Collection5/569.txt     \n","  inflating: Collection5/570.ann     \n","  inflating: Collection5/570.txt     \n","  inflating: Collection5/571.ann     \n","  inflating: Collection5/571.txt     \n","  inflating: Collection5/572.ann     \n","  inflating: Collection5/572.txt     \n","  inflating: Collection5/574.ann     \n","  inflating: Collection5/574.txt     \n","  inflating: Collection5/575.ann     \n","  inflating: Collection5/575.txt     \n","  inflating: Collection5/576.ann     \n","  inflating: Collection5/576.txt     \n","  inflating: Collection5/577.ann     \n","  inflating: Collection5/577.txt     \n","  inflating: Collection5/578.ann     \n","  inflating: Collection5/578.txt     \n","  inflating: Collection5/579.ann     \n","  inflating: Collection5/579.txt     \n","  inflating: Collection5/581.ann     \n","  inflating: Collection5/581.txt     \n","  inflating: Collection5/582.ann     \n","  inflating: Collection5/582.txt     \n","  inflating: Collection5/583.ann     \n","  inflating: Collection5/583.txt     \n","  inflating: Collection5/584 (!).ann  \n","  inflating: Collection5/584 (!).txt  \n","  inflating: Collection5/585.ann     \n","  inflating: Collection5/585.txt     \n","  inflating: Collection5/586.ann     \n","  inflating: Collection5/586.txt     \n","  inflating: Collection5/587.ann     \n","  inflating: Collection5/587.txt     \n","  inflating: Collection5/588.ann     \n","  inflating: Collection5/588.txt     \n","  inflating: Collection5/589.ann     \n","  inflating: Collection5/589.txt     \n","  inflating: Collection5/590.ann     \n","  inflating: Collection5/590.txt     \n","  inflating: Collection5/591.ann     \n","  inflating: Collection5/591.txt     \n","  inflating: Collection5/592.ann     \n","  inflating: Collection5/592.txt     \n","  inflating: Collection5/593.ann     \n","  inflating: Collection5/593.txt     \n","  inflating: Collection5/594.ann     \n","  inflating: Collection5/594.txt     \n","  inflating: Collection5/595.ann     \n","  inflating: Collection5/595.txt     \n","  inflating: Collection5/596.ann     \n","  inflating: Collection5/596.txt     \n","  inflating: Collection5/597.ann     \n","  inflating: Collection5/597.txt     \n","  inflating: Collection5/598 (!).ann  \n","  inflating: Collection5/598 (!).txt  \n","  inflating: Collection5/599.ann     \n","  inflating: Collection5/599.txt     \n","  inflating: Collection5/600.ann     \n","  inflating: Collection5/600.txt     \n","  inflating: Collection5/601.ann     \n","  inflating: Collection5/601.txt     \n","  inflating: Collection5/602.ann     \n","  inflating: Collection5/602.txt     \n","  inflating: Collection5/610.ann     \n","  inflating: Collection5/610.txt     \n","  inflating: Collection5/611.ann     \n","  inflating: Collection5/611.txt     \n","  inflating: Collection5/612.ann     \n","  inflating: Collection5/612.txt     \n","  inflating: Collection5/613.ann     \n","  inflating: Collection5/613.txt     \n","  inflating: Collection5/614.ann     \n","  inflating: Collection5/614.txt     \n","  inflating: Collection5/615.ann     \n","  inflating: Collection5/615.txt     \n","  inflating: Collection5/616.ann     \n","  inflating: Collection5/616.txt     \n","  inflating: Collection5/617.ann     \n","  inflating: Collection5/617.txt     \n","  inflating: Collection5/618.ann     \n","  inflating: Collection5/618.txt     \n","  inflating: Collection5/619.ann     \n","  inflating: Collection5/619.txt     \n","  inflating: Collection5/620.ann     \n","  inflating: Collection5/620.txt     \n","  inflating: Collection5/621.ann     \n","  inflating: Collection5/621.txt     \n","  inflating: Collection5/622.ann     \n","  inflating: Collection5/622.txt     \n","  inflating: Collection5/623.ann     \n","  inflating: Collection5/623.txt     \n","  inflating: Collection5/624.ann     \n","  inflating: Collection5/624.txt     \n","  inflating: Collection5/625.ann     \n","  inflating: Collection5/625.txt     \n","  inflating: Collection5/626.ann     \n","  inflating: Collection5/626.txt     \n","  inflating: Collection5/627.ann     \n","  inflating: Collection5/627.txt     \n","  inflating: Collection5/628.ann     \n","  inflating: Collection5/628.txt     \n","  inflating: Collection5/629.ann     \n","  inflating: Collection5/629.txt     \n","  inflating: Collection5/630.ann     \n","  inflating: Collection5/630.txt     \n","  inflating: Collection5/631.ann     \n","  inflating: Collection5/631.txt     \n","  inflating: Collection5/632.ann     \n","  inflating: Collection5/632.txt     \n","  inflating: Collection5/633.ann     \n","  inflating: Collection5/633.txt     \n","  inflating: Collection5/abdulatipov.ann  \n","  inflating: Collection5/abdulatipov.txt  \n","  inflating: Collection5/artjakov.ann  \n","  inflating: Collection5/artjakov.txt  \n","  inflating: Collection5/Avtovaz.ann  \n","  inflating: Collection5/Avtovaz.txt  \n","  inflating: Collection5/blokhin.ann  \n","  inflating: Collection5/blokhin.txt  \n","  inflating: Collection5/chaves.ann  \n","  inflating: Collection5/chaves.txt  \n","  inflating: Collection5/chirkunov.ann  \n","  inflating: Collection5/chirkunov.txt  \n","  inflating: Collection5/kamchatka.ann  \n","  inflating: Collection5/kamchatka.txt  \n","  inflating: Collection5/klinton.ann  \n","  inflating: Collection5/klinton.txt  \n","  inflating: Collection5/kuleshov.ann  \n","  inflating: Collection5/kuleshov.txt  \n","  inflating: Collection5/last_01.ann  \n","  inflating: Collection5/last_01.txt  \n","  inflating: Collection5/last_02.ann  \n","  inflating: Collection5/last_02.txt  \n","  inflating: Collection5/last_03.ann  \n","  inflating: Collection5/last_03.txt  \n","  inflating: Collection5/last_04.ann  \n","  inflating: Collection5/last_04.txt  \n","  inflating: Collection5/last_05.ann  \n","  inflating: Collection5/last_05.txt  \n","  inflating: Collection5/last_06.ann  \n","  inflating: Collection5/last_06.txt  \n","  inflating: Collection5/last_07_new.ann  \n","  inflating: Collection5/last_07_new.txt  \n","  inflating: Collection5/last_08.ann  \n","  inflating: Collection5/last_08.txt  \n","  inflating: Collection5/last_09.ann  \n","  inflating: Collection5/last_09.txt  \n","  inflating: Collection5/last_10.ann  \n","  inflating: Collection5/last_10.txt  \n","  inflating: Collection5/last_11.ann  \n","  inflating: Collection5/last_11.txt  \n","  inflating: Collection5/last_12.ann  \n","  inflating: Collection5/last_12.txt  \n","  inflating: Collection5/last_13.ann  \n","  inflating: Collection5/last_13.txt  \n","  inflating: Collection5/last_14.ann  \n","  inflating: Collection5/last_14.txt  \n","  inflating: Collection5/last_15.ann  \n","  inflating: Collection5/last_15.txt  \n","  inflating: Collection5/last_16.ann  \n","  inflating: Collection5/last_16.txt  \n","  inflating: Collection5/last_17.ann  \n","  inflating: Collection5/last_17.txt  \n","  inflating: Collection5/last_18.ann  \n","  inflating: Collection5/last_18.txt  \n","  inflating: Collection5/last_19.ann  \n","  inflating: Collection5/last_19.txt  \n","  inflating: Collection5/last_20.ann  \n","  inflating: Collection5/last_20.txt  \n","  inflating: Collection5/last_21.ann  \n","  inflating: Collection5/last_21.txt  \n","  inflating: Collection5/last_22.ann  \n","  inflating: Collection5/last_22.txt  \n","  inflating: Collection5/last_23.ann  \n","  inflating: Collection5/last_23.txt  \n","  inflating: Collection5/last_24.ann  \n","  inflating: Collection5/last_24.txt  \n","  inflating: Collection5/last_25.ann  \n","  inflating: Collection5/last_25.txt  \n","  inflating: Collection5/last_26.ann  \n","  inflating: Collection5/last_26.txt  \n","  inflating: Collection5/last_27.ann  \n","  inflating: Collection5/last_27.txt  \n","  inflating: Collection5/last_28.ann  \n","  inflating: Collection5/last_28.txt  \n","  inflating: Collection5/last_29.ann  \n","  inflating: Collection5/last_29.txt  \n","  inflating: Collection5/last_30_new.ann  \n","  inflating: Collection5/last_30_new.txt  \n","  inflating: Collection5/last_31.ann  \n","  inflating: Collection5/last_31.txt  \n","  inflating: Collection5/last_32.ann  \n","  inflating: Collection5/last_32.txt  \n","  inflating: Collection5/last_33.ann  \n","  inflating: Collection5/last_33.txt  \n","  inflating: Collection5/last_34.ann  \n","  inflating: Collection5/last_34.txt  \n","  inflating: Collection5/last_35.ann  \n","  inflating: Collection5/last_35.txt  \n","  inflating: Collection5/last_36.ann  \n","  inflating: Collection5/last_36.txt  \n","  inflating: Collection5/last_37.ann  \n","  inflating: Collection5/last_37.txt  \n","  inflating: Collection5/last_38.ann  \n","  inflating: Collection5/last_38.txt  \n","  inflating: Collection5/last_39.ann  \n","  inflating: Collection5/last_39.txt  \n","  inflating: Collection5/last_40.ann  \n","  inflating: Collection5/last_40.txt  \n","  inflating: Collection5/last_41.ann  \n","  inflating: Collection5/last_41.txt  \n","  inflating: Collection5/last_42.ann  \n","  inflating: Collection5/last_42.txt  \n","  inflating: Collection5/last_43.ann  \n","  inflating: Collection5/last_43.txt  \n","  inflating: Collection5/last_44.ann  \n","  inflating: Collection5/last_44.txt  \n","  inflating: Collection5/last_45.ann  \n","  inflating: Collection5/last_45.txt  \n","  inflating: Collection5/last_46.ann  \n","  inflating: Collection5/last_46.txt  \n","  inflating: Collection5/last_47.ann  \n","  inflating: Collection5/last_47.txt  \n","  inflating: Collection5/last_48.ann  \n","  inflating: Collection5/last_48.txt  \n","  inflating: Collection5/last_49.ann  \n","  inflating: Collection5/last_49.txt  \n","  inflating: Collection5/last_50.ann  \n","  inflating: Collection5/last_50.txt  \n","  inflating: Collection5/last_51.ann  \n","  inflating: Collection5/last_51.txt  \n","  inflating: Collection5/last_52.ann  \n","  inflating: Collection5/last_52.txt  \n","  inflating: Collection5/last_53.ann  \n","  inflating: Collection5/last_53.txt  \n","  inflating: Collection5/last_54.ann  \n","  inflating: Collection5/last_54.txt  \n","  inflating: Collection5/last_55.ann  \n","  inflating: Collection5/last_55.txt  \n","  inflating: Collection5/last_56.ann  \n","  inflating: Collection5/last_56.txt  \n","  inflating: Collection5/last_57.ann  \n","  inflating: Collection5/last_57.txt  \n","  inflating: Collection5/last_58.ann  \n","  inflating: Collection5/last_58.txt  \n","  inflating: Collection5/last_59.ann  \n","  inflating: Collection5/last_59.txt  \n","  inflating: Collection5/last_60.ann  \n","  inflating: Collection5/last_60.txt  \n","  inflating: Collection5/last_61.ann  \n","  inflating: Collection5/last_61.txt  \n","  inflating: Collection5/last_62.ann  \n","  inflating: Collection5/last_62.txt  \n","  inflating: Collection5/last_63.ann  \n","  inflating: Collection5/last_63.txt  \n","  inflating: Collection5/last_64.ann  \n","  inflating: Collection5/last_64.txt  \n","  inflating: Collection5/last_65.ann  \n","  inflating: Collection5/last_65.txt  \n","  inflating: Collection5/last_66.ann  \n","  inflating: Collection5/last_66.txt  \n","  inflating: Collection5/last_67.ann  \n","  inflating: Collection5/last_67.txt  \n","  inflating: Collection5/last_68.ann  \n","  inflating: Collection5/last_68.txt  \n","  inflating: Collection5/last_69.ann  \n","  inflating: Collection5/last_69.txt  \n","  inflating: Collection5/last_70.ann  \n","  inflating: Collection5/last_70.txt  \n","  inflating: Collection5/last_71.ann  \n","  inflating: Collection5/last_71.txt  \n","  inflating: Collection5/last_72.ann  \n","  inflating: Collection5/last_72.txt  \n","  inflating: Collection5/last_73.ann  \n","  inflating: Collection5/last_73.txt  \n","  inflating: Collection5/last_74.ann  \n","  inflating: Collection5/last_74.txt  \n","  inflating: Collection5/last_75.ann  \n","  inflating: Collection5/last_75.txt  \n","  inflating: Collection5/lenoblast.ann  \n","  inflating: Collection5/lenoblast.txt  \n","  inflating: Collection5/maykl dzhekson.ann  \n","  inflating: Collection5/maykl dzhekson.txt  \n","  inflating: Collection5/mvd.ann     \n","  inflating: Collection5/mvd.txt     \n","  inflating: Collection5/mvd2.ann    \n","  inflating: Collection5/mvd2.txt    \n","  inflating: Collection5/rosobrnadzor.ann  \n","  inflating: Collection5/rosobrnadzor.txt  \n","  inflating: Collection5/ryadovoy chelah.ann  \n","  inflating: Collection5/ryadovoy chelah.txt  \n","  inflating: Collection5/semenenko.ann  \n","  inflating: Collection5/semenenko.txt  \n","  inflating: Collection5/shojgu1.ann  \n","  inflating: Collection5/shojgu1.txt  \n","  inflating: Collection5/shojgu3.ann  \n","  inflating: Collection5/shojgu3.txt  \n","  inflating: Collection5/shojgu4.ann  \n","  inflating: Collection5/shojgu4.txt  \n","  inflating: Collection5/shojgu6.ann  \n","  inflating: Collection5/shojgu6.txt  \n","  inflating: Collection5/si_tzjanpin.ann  \n","  inflating: Collection5/si_tzjanpin.txt  \n","  inflating: Collection5/sobjanin2.ann  \n","  inflating: Collection5/sobjanin2.txt  \n","  inflating: Collection5/turkmenija.ann  \n","  inflating: Collection5/turkmenija.txt  \n","  inflating: Collection5/uchitel.ann  \n","  inflating: Collection5/uchitel.txt  \n"]}],"source":["!unzip collection5.zip"]},{"cell_type":"code","execution_count":37,"metadata":{"id":"2vMqouERbotU","executionInfo":{"status":"ok","timestamp":1728399207105,"user_tz":-300,"elapsed":31,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"YKdl1M9dbotU"},"source":["Если у падает при считавании русского языка то надо самим исправить этот момент\n","\n","ссылка на код\n","https://github.com/natasha/corus/blob/master/corus/sources/ne5.py\n","\n","скорее всего падает на считывании самого текста, поэтому при считывании просто добавьте кодировку в сам модуль и всё будет хорошо отрабатывать, к сожалению автор пока не поправил этото момент\n","\n","`\n","with open(path, encoding=\"utf-8\") as file:\n","`"]},{"cell_type":"code","execution_count":38,"metadata":{"scrolled":true,"colab":{"base_uri":"https://localhost:8080/"},"id":"0Ax4CAkCbotU","executionInfo":{"status":"ok","timestamp":1728399207105,"user_tz":-300,"elapsed":31,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"15909a5d-52c4-44ef-f5ff-c470c7504c8b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Ne5Markup(\n","    id='03_12_12a',\n","    text='Мнение: Шансы Гудкова стать губернатором Подмосковья зависят от ситуации\\r\\n\\r\\nВице-президент Центра политических технологий Георгий Чижов довольно скептично оценил вероятность избрания эсэра Геннадия Гудкова губернатором Московской области.\\r\\n\\r\\n\"С одной стороны, Геннадий Гудков - это готовый оппозиционный кандидат, который имеет все шансы стать единым кандидатом, - заявил Чижов корреспонденту ИА REGNUM. - Конечно, потенциал его велик, но при нынешней сложившейся ситуации и том сроке, который остался до выборов, я думаю, у власти достаточно возможностей, чтобы его дискредитировать и лишить шанса быть избранным. Очень много будет зависеть от того, как будет развиваться ситуация. Если протестные настроения будут расти, конечно, у него наибольшие шансы из всех оппозиционных кандидатов победить в Московской области, тем более, что у него есть связи в элитах очень неплохие. И в принципе его может поддержать часть элит, если не будет большого давления. Но пока, глядя на сегодняшний день, скорее всего, победит исполняющий обязанности губернатора, если принципиальных изменений не будет, а они, конечно, могут случиться за этот год\".\\r\\n\\r\\nРанее ИА REGNUM сообщало, что пост губернатора Подмосковья стал вакантным после того, как бывший губернатор Сергей Шойгу был назначен министром обороны РФ. Выборы главы региона назначены на сентябрь 2013 года. 8 ноября стало известно, что президент Владимир Путин назначил Андрея Воробьева исполнять обязанности губернатора Подмосковья.',\n","    spans=[Ne5Span(\n","         index='T1',\n","         type='PER',\n","         start=14,\n","         stop=21,\n","         text='Гудкова'\n","     ),\n","     Ne5Span(\n","         index='T2',\n","         type='LOC',\n","         start=41,\n","         stop=52,\n","         text='Подмосковья'\n","     ),\n","     Ne5Span(\n","         index='T3',\n","         type='ORG',\n","         start=91,\n","         stop=121,\n","         text='Центра политических технологий'\n","     ),\n","     Ne5Span(\n","         index='T4',\n","         type='PER',\n","         start=122,\n","         stop=135,\n","         text='Георгий Чижов'\n","     ),\n","     Ne5Span(\n","         index='T5',\n","         type='PER',\n","         start=189,\n","         stop=205,\n","         text='Геннадия Гудкова'\n","     ),\n","     Ne5Span(\n","         index='T6',\n","         type='LOC',\n","         start=219,\n","         stop=237,\n","         text='Московской области'\n","     ),\n","     Ne5Span(\n","         index='T7',\n","         type='PER',\n","         start=260,\n","         stop=275,\n","         text='Геннадий Гудков'\n","     ),\n","     Ne5Span(\n","         index='T8',\n","         type='PER',\n","         start=372,\n","         stop=377,\n","         text='Чижов'\n","     ),\n","     Ne5Span(\n","         index='T9',\n","         type='MEDIA',\n","         start=393,\n","         stop=402,\n","         text='ИА REGNUM'\n","     ),\n","     Ne5Span(\n","         index='T10',\n","         type='LOC',\n","         start=800,\n","         stop=818,\n","         text='Московской области'\n","     ),\n","     Ne5Span(\n","         index='T11',\n","         type='MEDIA',\n","         start=1147,\n","         stop=1156,\n","         text='ИА REGNUM'\n","     ),\n","     Ne5Span(\n","         index='T12',\n","         type='LOC',\n","         start=1188,\n","         stop=1199,\n","         text='Подмосковья'\n","     ),\n","     Ne5Span(\n","         index='T13',\n","         type='PER',\n","         start=1249,\n","         stop=1261,\n","         text='Сергей Шойгу'\n","     ),\n","     Ne5Span(\n","         index='T14',\n","         type='GEOPOLIT',\n","         start=1293,\n","         stop=1295,\n","         text='РФ'\n","     ),\n","     Ne5Span(\n","         index='T15',\n","         type='PER',\n","         start=1390,\n","         stop=1404,\n","         text='Владимир Путин'\n","     ),\n","     Ne5Span(\n","         index='T16',\n","         type='PER',\n","         start=1414,\n","         stop=1430,\n","         text='Андрея Воробьева'\n","     ),\n","     Ne5Span(\n","         index='T17',\n","         type='LOC',\n","         start=1465,\n","         stop=1476,\n","         text='Подмосковья'\n","     )]\n",")"]},"metadata":{},"execution_count":38}],"source":["from corus import load_ne5\n","\n","path_coll5 = 'Collection5/'\n","records = load_ne5(path_coll5)\n","next(records)"]},{"cell_type":"code","execution_count":39,"metadata":{"id":"yKolSqXJbotV","executionInfo":{"status":"ok","timestamp":1728399207105,"user_tz":-300,"elapsed":5,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["# !pip install razdel"]},{"cell_type":"code","execution_count":40,"metadata":{"id":"cKIsmbnAbotV","executionInfo":{"status":"ok","timestamp":1728399207106,"user_tz":-300,"elapsed":6,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["from razdel import tokenize"]},{"cell_type":"code","execution_count":41,"metadata":{"id":"KCWJkIPqbotV","executionInfo":{"status":"ok","timestamp":1728399218263,"user_tz":-300,"elapsed":11162,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["words_docs = []\n","for ix, rec in enumerate(records):\n","    words = []\n","    for token in tokenize(rec.text):\n","        type_ent = 'OUT'\n","        for ent in rec.spans:\n","            if (token.start >= ent.start) and (token.stop <= ent.stop):\n","                type_ent = ent.type\n","                break\n","        words.append([token.text, type_ent])\n","    words_docs.extend(words)"]},{"cell_type":"code","execution_count":42,"metadata":{"id":"OAFuhmGIbotV","executionInfo":{"status":"ok","timestamp":1728399218264,"user_tz":-300,"elapsed":11,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["import pandas as pd"]},{"cell_type":"code","execution_count":43,"metadata":{"id":"mipKWWzvbotV","executionInfo":{"status":"ok","timestamp":1728399218265,"user_tz":-300,"elapsed":11,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["df_words = pd.DataFrame(words_docs, columns=['word', 'tag'])"]},{"cell_type":"code","execution_count":44,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":358},"id":"f89JJEnAbotV","executionInfo":{"status":"ok","timestamp":1728399218265,"user_tz":-300,"elapsed":10,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"3cf353a8-f9d9-46d4-e2c0-a491bc13e6ce"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/google/colab/_reprs.py:217: FutureWarning: Index.format is deprecated and will be removed in a future version. Convert using index.astype(str) or index.map(formatter) instead.\n","  series_as_table_html = series.to_frame()._repr_html_()  # pylint: disable=protected-access\n"]},{"output_type":"execute_result","data":{"text/plain":["tag\n","OUT         219003\n","PER          21186\n","ORG          13648\n","LOC           4561\n","GEOPOLIT      4355\n","MEDIA         2478\n","Name: count, dtype: int64"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>count</th>\n","    </tr>\n","    <tr>\n","      <th>tag</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>OUT</th>\n","      <td>219003</td>\n","    </tr>\n","    <tr>\n","      <th>PER</th>\n","      <td>21186</td>\n","    </tr>\n","    <tr>\n","      <th>ORG</th>\n","      <td>13648</td>\n","    </tr>\n","    <tr>\n","      <th>LOC</th>\n","      <td>4561</td>\n","    </tr>\n","    <tr>\n","      <th>GEOPOLIT</th>\n","      <td>4355</td>\n","    </tr>\n","    <tr>\n","      <th>MEDIA</th>\n","      <td>2478</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div><br><label><b>dtype:</b> int64</label>"]},"metadata":{},"execution_count":44}],"source":["df_words['tag'].value_counts()"]},{"cell_type":"code","execution_count":45,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":233},"id":"57WN3DM_botW","executionInfo":{"status":"ok","timestamp":1728399218623,"user_tz":-300,"elapsed":366,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"aa2a3d74-8733-4c2f-923c-ce69197cc729"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/google/colab/_interactive_table_hint_button.py:178: FutureWarning: Index.format is deprecated and will be removed in a future version. Convert using index.astype(str) or index.map(formatter) instead.\n","  df_html=dataframe._repr_html_(),  # pylint: disable=protected-access\n","/usr/local/lib/python3.10/dist-packages/google/colab/_interactive_table_hint_button.py:178: FutureWarning: RangeIndex.format is deprecated and will be removed in a future version. Convert using index.astype(str) or index.map(formatter) instead.\n","  df_html=dataframe._repr_html_(),  # pylint: disable=protected-access\n"]},{"output_type":"execute_result","data":{"text/plain":["       word  tag\n","0         Д  PER\n","1         .  PER\n","2  Медведев  PER"],"text/html":["\n","  <div id=\"df-9bbc6766-6902-4a25-a31e-fc4beb6c9ac1\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>word</th>\n","      <th>tag</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Д</td>\n","      <td>PER</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>.</td>\n","      <td>PER</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Медведев</td>\n","      <td>PER</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9bbc6766-6902-4a25-a31e-fc4beb6c9ac1')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-9bbc6766-6902-4a25-a31e-fc4beb6c9ac1 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-9bbc6766-6902-4a25-a31e-fc4beb6c9ac1');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-1d8a913a-ed21-4bf2-bead-971d94683d08\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-1d8a913a-ed21-4bf2-bead-971d94683d08')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-1d8a913a-ed21-4bf2-bead-971d94683d08 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"df_words"}},"metadata":{},"execution_count":45}],"source":["df_words.head(3)"]},{"cell_type":"code","execution_count":46,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"mnsXjAEibotW","executionInfo":{"status":"ok","timestamp":1728399218623,"user_tz":-300,"elapsed":7,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"d791e33a-d5fd-4a0f-a775-dc28ee901a6b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(265231, 2)"]},"metadata":{},"execution_count":46}],"source":["df_words.shape"]},{"cell_type":"code","execution_count":50,"metadata":{"id":"ZcY8Esw5botW","executionInfo":{"status":"ok","timestamp":1728399276057,"user_tz":-300,"elapsed":303,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["import tensorflow as tf\n","\n","from tensorflow.keras import Sequential\n","from tensorflow.keras.layers import Dense, Embedding, GlobalAveragePooling1D, GlobalMaxPooling1D, Conv1D, GRU, LSTM, Dropout, Input\n","from tensorflow.keras.layers import TextVectorization"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"ZrxY9wMQbotX","executionInfo":{"status":"ok","timestamp":1728399279542,"user_tz":-300,"elapsed":294,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["from sklearn import model_selection, preprocessing, linear_model\n","\n","train_x, valid_x, train_y, valid_y = model_selection.train_test_split(df_words['word'], df_words['tag'])\n","\n","# labelEncode целевую переменную\n","encoder = preprocessing.LabelEncoder()\n","train_y = encoder.fit_transform(train_y)\n","valid_y = encoder.fit_transform(valid_y)"]},{"cell_type":"code","execution_count":52,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MxhUQMnibotX","executionInfo":{"status":"ok","timestamp":1728399282636,"user_tz":-300,"elapsed":347,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"15775c3e-98c7-4a41-f38f-f9026e99ec08"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["55"]},"metadata":{},"execution_count":52}],"source":["train_x.apply(len).max(axis=0)"]},{"cell_type":"code","execution_count":53,"metadata":{"id":"ZInjQ6QcbotY","executionInfo":{"status":"ok","timestamp":1728399282938,"user_tz":-300,"elapsed":4,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["# char level\n","#train_x = train_x.apply(lambda x: ' '.join(list(x)))\n","#valid_x = valid_x.apply(lambda x: ' '.join(list(x)))"]},{"cell_type":"code","execution_count":54,"metadata":{"id":"XJ8XOTJJbotY","executionInfo":{"status":"ok","timestamp":1728399283317,"user_tz":-300,"elapsed":382,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["train_data = tf.data.Dataset.from_tensor_slices((train_x, train_y))\n","valid_data = tf.data.Dataset.from_tensor_slices((valid_x, valid_y))\n","\n","train_data = train_data.batch(16)\n","valid_data = valid_data.batch(16)"]},{"cell_type":"code","execution_count":55,"metadata":{"id":"aJHEViwgbotZ","executionInfo":{"status":"ok","timestamp":1728399283725,"user_tz":-300,"elapsed":411,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["AUTOTUNE = tf.data.AUTOTUNE\n","\n","train_data = train_data.cache().prefetch(buffer_size=AUTOTUNE)\n","valid_data = valid_data.cache().prefetch(buffer_size=AUTOTUNE)"]},{"cell_type":"code","execution_count":56,"metadata":{"id":"vN_eWvflbotZ","executionInfo":{"status":"ok","timestamp":1728399365865,"user_tz":-300,"elapsed":82143,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["def custom_standardization(input_data):\n","    return input_data\n","\n","vocab_size = 30000\n","seq_len = 10\n","\n","vectorize_layer = TextVectorization(\n","    standardize=custom_standardization,\n","    max_tokens=vocab_size,\n","    output_mode='int',\n","    #ngrams=(1, 3),\n","    output_sequence_length=seq_len)\n","\n","# Make a text-only dataset (no labels) and call adapt to build the vocabulary.\n","text_data = train_data.map(lambda x, y: x)\n","vectorize_layer.adapt(text_data)"]},{"cell_type":"code","execution_count":57,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BYoDa_FKbotZ","executionInfo":{"status":"ok","timestamp":1728399365866,"user_tz":-300,"elapsed":36,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"a28d5267-73ee-450a-c94a-0e2aa847eb81"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["29845"]},"metadata":{},"execution_count":57}],"source":["len(vectorize_layer.get_vocabulary())"]},{"cell_type":"code","execution_count":58,"metadata":{"id":"_P2rfxf7bota","executionInfo":{"status":"ok","timestamp":1728399365867,"user_tz":-300,"elapsed":33,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["embedding_dim = 64\n","\n","class modelNER(tf.keras.Model):\n","    def __init__(self):\n","        super(modelNER, self).__init__()\n","        self.emb = Embedding(vocab_size, embedding_dim)\n","        self.gPool = GlobalMaxPooling1D()\n","        self.fc1 = Dense(300, activation='relu')\n","        self.fc2 = Dense(50, activation='relu')\n","        self.fc3 = Dense(6, activation='softmax')\n","\n","    def call(self, x):\n","        x = vectorize_layer(x)\n","        x = self.emb(x)\n","        pool_x = self.gPool(x)\n","\n","        fc_x = self.fc1(pool_x)\n","        fc_x = self.fc2(fc_x)\n","\n","        concat_x = tf.concat([pool_x, fc_x], axis=1)\n","        prob = self.fc3(concat_x)\n","        return prob"]},{"cell_type":"code","execution_count":59,"metadata":{"id":"viu3hJoWbotb","executionInfo":{"status":"ok","timestamp":1728399365867,"user_tz":-300,"elapsed":32,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["mmodel = modelNER()"]},{"cell_type":"code","execution_count":60,"metadata":{"id":"Cn2LZGLUbotb","executionInfo":{"status":"ok","timestamp":1728399366193,"user_tz":-300,"elapsed":357,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":["mmodel.compile(optimizer='adam',\n","              loss=tf.keras.losses.SparseCategoricalCrossentropy(),\n","              metrics=['accuracy'])"]},{"cell_type":"code","execution_count":61,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yAy3HBlrbotb","executionInfo":{"status":"ok","timestamp":1728400270711,"user_tz":-300,"elapsed":904523,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}},"outputId":"d30a3580-8f12-4bc1-8a1e-ac2dacd21a90"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/3\n","\u001b[1m12433/12433\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m298s\u001b[0m 24ms/step - accuracy: 0.8886 - loss: 0.3939 - val_accuracy: 0.9388 - val_loss: 0.2091\n","Epoch 2/3\n","\u001b[1m12433/12433\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m285s\u001b[0m 23ms/step - accuracy: 0.9590 - loss: 0.1367 - val_accuracy: 0.9412 - val_loss: 0.2292\n","Epoch 3/3\n","\u001b[1m12433/12433\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m286s\u001b[0m 23ms/step - accuracy: 0.9645 - loss: 0.1125 - val_accuracy: 0.9410 - val_loss: 0.2530\n"]},{"output_type":"execute_result","data":{"text/plain":["<keras.src.callbacks.history.History at 0x7e5170bfe1a0>"]},"metadata":{},"execution_count":61}],"source":["mmodel.fit(train_data, validation_data=valid_data, epochs=3)"]},{"cell_type":"code","execution_count":61,"metadata":{"id":"IYVCBD32botc","executionInfo":{"status":"ok","timestamp":1728400270712,"user_tz":-300,"elapsed":7,"user":{"displayName":"Дмитрий Милютин (LOGER865)","userId":"15455955318369743455"}}},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.9.13"},"colab":{"provenance":[]}},"nbformat":4,"nbformat_minor":0}